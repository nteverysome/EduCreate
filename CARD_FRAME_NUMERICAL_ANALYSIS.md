# 卡片與外框數值分析 - 3對卡片佈局

## 實際數值計算

### 📊 **遊戲容器尺寸**
```
寬度: 1841px
高度: 674px
```

### 📍 **左側容器位置計算**
```
leftX = width * 0.125 = 1841 * 0.125 = 230.125px
leftStartY = height * 0.15 = 674 * 0.15 = 101.1px
```

### 📐 **卡片尺寸**
```
cardWidth = 280px
cardHeight = 150px
```

### 🔄 **佈局信息**
```
leftLayout.columns = 1
leftLayout.rows = 3
dynamicSpacing = 74.14px (動態計算)
```

### 📦 **外框尺寸計算**
```
leftContainerHeight = rows * cardHeight + (rows - 1) * spacing
                   = 3 * 150 + 2 * 74.14
                   = 450 + 148.28
                   = 598.28px

boxWidth = cardWidth + padding * 2
         = 280 + 10 * 2
         = 300px

boxHeight = containerHeight + padding * 2 + topPadding
          = 598.28 + 10 * 2 + 15
          = 598.28 + 20 + 15
          = 633.28px
```

---

## 卡片位置詳細計算

### 🎴 **卡片 1（索引 0）**
```
row = 0, col = 0

cardX = leftX + col * (cardWidth + spacing)
      = 230.125 + 0 * (280 + 74.14)
      = 230.125px

cardY = leftStartY + row * (cardHeight + spacing)
      = 101.1 + 0 * (150 + 74.14)
      = 101.1px

卡片邊界：
  左: 230.125 - 280/2 = 230.125 - 140 = 90.125px
  右: 230.125 + 280/2 = 230.125 + 140 = 370.125px
  上: 101.1 - 150/2 = 101.1 - 75 = 26.1px
  下: 101.1 + 150/2 = 101.1 + 75 = 176.1px
```

### 🎴 **卡片 2（索引 1）**
```
row = 1, col = 0

cardX = 230.125 + 0 * (280 + 74.14) = 230.125px

cardY = 101.1 + 1 * (150 + 74.14)
      = 101.1 + 224.14
      = 325.24px

卡片邊界：
  左: 90.125px
  右: 370.125px
  上: 325.24 - 75 = 250.24px
  下: 325.24 + 75 = 400.24px
```

### 🎴 **卡片 3（索引 2）**
```
row = 2, col = 0

cardX = 230.125px

cardY = 101.1 + 2 * (150 + 74.14)
      = 101.1 + 448.28
      = 549.38px

卡片邊界：
  左: 90.125px
  右: 370.125px
  上: 549.38 - 75 = 474.38px
  下: 549.38 + 75 = 624.38px
```

---

## 外框位置計算

### 📦 **外框中心位置**
```
boxCenterX = leftX = 230.125px

boxCenterY = leftStartY + padding + topPadding + containerHeight / 2
           = 101.1 + 10 + 15 + 598.28 / 2
           = 101.1 + 10 + 15 + 299.14
           = 425.24px
```

### 📦 **外框邊界**
```
左邊界 = boxCenterX - boxWidth / 2
       = 230.125 - 300 / 2
       = 230.125 - 150
       = 80.125px

右邊界 = boxCenterX + boxWidth / 2
       = 230.125 + 150
       = 380.125px

上邊界 = boxCenterY - boxHeight / 2
       = 425.24 - 633.28 / 2
       = 425.24 - 316.64
       = 108.6px

下邊界 = boxCenterY + boxHeight / 2
       = 425.24 + 316.64
       = 741.88px
```

---

## 卡片是否在外框內的驗證

### ✅ **卡片 1 驗證**
```
卡片邊界: 左90.125, 右370.125, 上26.1, 下176.1
外框邊界: 左80.125, 右380.125, 上108.6, 下741.88

檢查：
  左: 90.125 >= 80.125 ✅
  右: 370.125 <= 380.125 ✅
  上: 26.1 >= 108.6 ❌ 卡片超出上邊界！
  下: 176.1 <= 741.88 ✅

結果: ❌ 卡片 1 超出外框上邊界 81.5px
```

### ✅ **卡片 2 驗證**
```
卡片邊界: 左90.125, 右370.125, 上250.24, 下400.24
外框邊界: 左80.125, 右380.125, 上108.6, 下741.88

檢查：
  左: 90.125 >= 80.125 ✅
  右: 370.125 <= 380.125 ✅
  上: 250.24 >= 108.6 ✅
  下: 400.24 <= 741.88 ✅

結果: ✅ 卡片 2 在框內
```

### ✅ **卡片 3 驗證**
```
卡片邊界: 左90.125, 右370.125, 上474.38, 下624.38
外框邊界: 左80.125, 右380.125, 上108.6, 下741.88

檢查：
  左: 90.125 >= 80.125 ✅
  右: 370.125 <= 380.125 ✅
  上: 474.38 >= 108.6 ✅
  下: 624.38 <= 741.88 ✅

結果: ✅ 卡片 3 在框內
```

---

## 🔴 **根本問題發現**

### 問題 1：外框上邊界計算錯誤

**當前計算：**
```
上邊界 = boxCenterY - boxHeight / 2
       = 425.24 - 316.64
       = 108.6px
```

**問題：**
- 卡片 1 的上邊界是 26.1px
- 外框的上邊界是 108.6px
- 卡片 1 超出外框 81.5px！

### 問題 2：boxCenterY 計算邏輯不清楚

```javascript
boxCenterY = leftStartY + padding + topPadding + containerHeight / 2
           = 101.1 + 10 + 15 + 299.14
           = 425.24px
```

**分析：**
- `leftStartY` = 101.1px（第一個卡片的 Y 位置）
- `padding` = 10px（外框內邊距）
- `topPadding` = 15px（額外頂部空間）
- `containerHeight / 2` = 299.14px（容器高度的一半）

**問題：**
- 這個公式假設外框的上邊界在 `leftStartY + padding + topPadding`
- 但實際上，第一個卡片的上邊界在 `leftStartY - cardHeight/2 = 26.1px`
- 所以外框的上邊界應該在 `26.1 - padding = 16.1px`

### 問題 3：外框應該從卡片的實際邊界開始計算

**正確的計算應該是：**

```
第一個卡片的上邊界 = leftStartY - cardHeight / 2 = 26.1px
最後一個卡片的下邊界 = leftStartY + (rows-1) * (cardHeight + spacing) + cardHeight / 2
                    = 101.1 + 2 * 224.14 + 75
                    = 624.38px

外框應該包含所有卡片，所以：
外框上邊界 = 第一個卡片上邊界 - padding = 26.1 - 10 = 16.1px
外框下邊界 = 最後一個卡片下邊界 + padding = 624.38 + 10 = 634.38px

外框中心 Y = (外框上邊界 + 外框下邊界) / 2
           = (16.1 + 634.38) / 2
           = 325.24px

外框高度 = 外框下邊界 - 外框上邊界 + topPadding
         = 618.28 + 15
         = 633.28px
```

---

## 📋 **總結**

| 項目 | 當前值 | 正確值 | 差異 |
|------|-------|-------|------|
| 外框上邊界 | 108.6px | 16.1px | -92.5px ❌ |
| 外框中心Y | 425.24px | 325.24px | -100px ❌ |
| 卡片1超出 | 81.5px | 0px | 81.5px ❌ |

**結論：** 外框的 Y 軸位置計算完全錯誤，導致卡片超出框外！

