---
type: "always_apply"
---

# 代碼開發與驗證規範

## 核心原則
所有提供的代碼必須是完整、可驗證、真實可用的功能實現，且必須經過Playwright 全方位自動化規範後才能交付。

## 第一部分：代碼開發標準

### 代碼完整性標準
- 提供的代碼必須包含所有必要的依賴和配置
- 所有函數和方法必須有完整實現，不得使用 TODO 或佔位符
- 必須包含錯誤處理和邊緣情況處理
- 提供完整的匯入/匯出和模組相依性

### 功能驗證要求
- 每個功能必須提供**具體的驗證步驟**
- 包含**可執行的測試範例**或**驗證指令**
- 說明如何確認功能正常運作
- 提供預期的輸出結果或行為

### 環境和依賴說明
- 明確列出所有必要的依賴套件和版本
- 提供環境設定和安裝步驟
- 說明任何必要的配置檔案或環境變數
- 確認代碼在指定環境下可正常執行

### 開發階段禁止事項
- 不得聲稱代碼"已完成"而實際上缺少關鍵功能
- 不得提供未經驗證的代碼片段
- 不得使用虛假的範例數據掩蓋功能缺陷
- 不得跳過必要的錯誤處理或驗證邏輯

## 第二部分：自動驗證流程

### 強制驗證要求
**所有代碼必須經過自動驗證測試後才能交付，不得提供未經驗證的代碼。**

### JavaScript/Node.js 代碼驗證
- **必須使用 analysis tool 執行驗證**後才能交付
- 驗證所有函數的基本功能和輸出
- 測試錯誤處理和邊緣情況
- 確認依賴載入和模組匯入正常

### 其他語言代碼驗證
- 必須進行**完整的邏輯模擬驗證**
- 逐行檢查語法和邏輯正確性
- 驗證所有變數宣告和型別使用
- 確認所有依賴和 import 語句正確

### 配置檔案和腳本驗證
- 驗證語法結構正確性
- 檢查所有必要的配置項目
- 確認檔案路徑和相依性存在
- 模擬執行流程確認邏輯

### E2E 測試代碼特殊要求
當提供 Playwright E2E 測試代碼時，除了基本驗證外，還必須：

#### 環境配置驗證
- **必須遵循 @Playwright端到端測試規範** 的所有要求
- 確保測試代碼使用真實環境配置（非靜態或 mock 環境）
- 驗證 baseURL 指向完全功能的測試環境
- 包含 globalSetup 檢查後端服務、資料庫連接的代碼

#### 真實性驗證要求
- 測試腳本必須驗證完整的用戶互動流程
- 禁止跳過關鍵的等待和互動步驟
- 確保所有選擇器對應真實 DOM 元素
- 驗證表單提交、動態載入、即時驗證等功能

#### 完整技術棧檢查
- 包含環境檢查代碼（API、資料庫、第三方服務可用性）
- 驗證測試數據的真實性和完整性
- 確保錯誤處理涵蓋網絡中斷、伺服器錯誤等真實情況
- 包含並發操作和數據衝突的處理驗證

#### E2E 測試驗證模板
```javascript
// E2E 測試代碼的 analysis tool 驗證範例
console.log("=== E2E 測試代碼驗證開始 ===");

// 1. 配置驗證
try {
  // 檢查是否使用真實環境
  const config = require('./playwright.config.js');
  console.log("✅ 基本配置檢查:", config.use.baseURL);
  
  // 驗證不是靜態或 mock 環境
  if (config.use.baseURL.includes('localhost:3000') || 
      config.use.baseURL.includes('mock')) {
    console.log("⚠️  警告：可能使用簡化環境");
  }
} catch (error) {
  console.log("❌ 配置檢查失敗:", error.message);
}

// 2. 測試流程邏輯驗證
try {
  // 模擬測試步驟邏輯
  console.log("✅ 測試流程邏輯正確");
} catch (error) {
  console.log("❌ 測試邏輯錯誤:", error.message);
}

// 3. 環境依賴檢查
console.log("✅ 環境依賴驗證：需要確認後端服務可用");

console.log("=== E2E 測試驗證完成 ===");