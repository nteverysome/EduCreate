# 垂直間距 vs 中文字高度 - 為什麼不是 32px？

## 🎯 核心問題

**為什麼 verticalSpacing 是 22.32px，而不是 32px（中文字高度）？**

---

## 📍 兩個不同的概念

### 1️⃣ 垂直間距 (verticalSpacing)

```javascript
const verticalSpacing = Math.max(10, Math.min(40, availableHeight * 0.03));
                      = Math.max(10, Math.min(40, 744 * 0.03))
                      = Math.max(10, Math.min(40, 22.32))
                      = 22.32px
```

**作用**：卡片之間的距離（垂直方向）

```
┌──────────────────────────────────────┐
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 英文 │  │ 英文 │  │ 英文 │       │
│  │ 中文 │  │ 中文 │  │ 中文 │       │
│  └──────┘  └──────┘  └──────┘       │
│     ↑                                 │
│  22px（verticalSpacing）             │
│     ↓                                 │
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 英文 │  │ 英文 │  │ 英文 │       │
│  │ 中文 │  │ 中文 │  │ 中文 │       │
│  └──────┘  └──────┘  └──────┘       │
│                                       │
└──────────────────────────────────────┘
```

### 2️⃣ 中文字高度 (chineseTextHeight)

```javascript
const chineseTextHeight = finalCardHeight * 0.4;
                        = 80 * 0.4
                        = 32px
```

**作用**：中文字框的高度（在英文卡片下方）

```
┌──────────────────────────────────────┐
│  ┌──────────────────────────────┐   │
│  │                              │   │
│  │      英文卡片 (80px)         │   │
│  │                              │   │
│  └──────────────────────────────┘   │
│  ┌──────────────────────────────┐   │
│  │  中文字 (32px = 80 × 0.4)    │   │
│  └──────────────────────────────┘   │
│                                       │
└──────────────────────────────────────┘
```

---

## 🔍 為什麼不是 32px？

### 原因 1：計算基礎不同

#### verticalSpacing 的計算基礎

```
基礎：可用高度 (availableHeight)
公式：availableHeight × 0.03
計算：744 × 0.03 = 22.32px

目的：根據屏幕大小動態調整卡片之間的距離
```

#### chineseTextHeight 的計算基礎

```
基礎：卡片高度 (cardHeight)
公式：cardHeight × 0.4
計算：80 × 0.4 = 32px

目的：根據卡片大小動態調整中文字框的高度
```

### 原因 2：作用不同

#### verticalSpacing 的作用

```
作用：分隔卡片行
位置：卡片之間（上下方向）
影響：卡片排列、屏幕利用率
```

#### chineseTextHeight 的作用

```
作用：容納中文字
位置：英文卡片下方
影響：中文字可讀性、卡片單元高度
```

### 原因 3：如果 verticalSpacing 設為 32px 會怎樣？

#### 計算過程

```
原始（22.32px）：
- 4 行卡片的間距總計：22.32 × 5 = 111.6px
- 卡片總高度：744 - 111.6 = 632.4px
- 每行卡片高度：632.4 / 4 = 158.1px

如果改為 32px：
- 4 行卡片的間距總計：32 × 5 = 160px
- 卡片總高度：744 - 160 = 584px
- 每行卡片高度：584 / 4 = 146px

差異：
- 間距增加：22.32 → 32px（+43%）
- 卡片高度減少：158.1 → 146px（-7.6%）
```

#### 視覺效果對比

```
原始（22.32px）：
┌──────────────────────────────────────┐
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 80px │  │ 80px │  │ 80px │       │
│  └──────┘  └──────┘  └──────┘       │
│     ↑                                 │
│  22px                                │
│     ↓                                 │
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 80px │  │ 80px │  │ 80px │       │
│  └──────┘  └──────┘  └──────┘       │
│                                       │
└──────────────────────────────────────┘

如果改為 32px：
┌──────────────────────────────────────┐
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 73px │  │ 73px │  │ 73px │       │
│  └──────┘  └──────┘  └──────┘       │
│     ↑                                 │
│  32px（太大）                        │
│     ↓                                 │
│  ┌──────┐  ┌──────┐  ┌──────┐       │
│  │ card │  │ card │  │ card │       │
│  │ 73px │  │ 73px │  │ 73px │       │
│  └──────┘  └──────┘  └──────┘       │
│                                       │
└──────────────────────────────────────┘

問題：
❌ 卡片變小了
❌ 間距變大了
❌ 屏幕利用率降低
```

---

## 📊 完整的計算流程

### 第一步：計算可用高度

```
屏幕高度：844px
頂部按鈕區域：50px
底部按鈕區域：50px
可用高度：844 - 50 - 50 = 744px
```

### 第二步：計算垂直間距

```
公式：availableHeight × 0.03
計算：744 × 0.03 = 22.32px
範圍：10px - 40px
結果：22.32px ✅
```

### 第三步：計算卡片高度

```
基於高度的計算：
- 可用行數：4 行
- 每行可用高度：(744 - 22.32 × 5) / 4 = 158.1px
- 卡片高度：(158.1 - 22.32) / 1.4 = 96.9px

基於寬度的計算：
- 可用列數：5 列
- 每列可用寬度：(390 - 24 × 6) / 5 = 69.6px
- 卡片寬度：69.6px

取較小值：69.6px（受寬度限制）
最終卡片高度：80px（受最小值限制）
```

### 第四步：計算中文字高度

```
公式：cardHeight × 0.4
計算：80 × 0.4 = 32px
結果：32px ✅
```

### 第五步：計算單元總高度

```
公式：cardHeight + chineseTextHeight + verticalSpacing
計算：80 + 32 + 22.32 = 134.32px
結果：134.32px ✅
```

---

## 🎯 為什麼要分開計算？

### 1. 獨立性

```
verticalSpacing：
- 基於屏幕高度
- 控制卡片之間的距離
- 獨立計算

chineseTextHeight：
- 基於卡片高度
- 控制中文字框的大小
- 獨立計算

它們各自獨立，互不影響
```

### 2. 靈活性

```
如果要改變間距：
- 只需改變 verticalSpacing 的比例（3% → 2% 或 4%）
- 不影響中文字高度

如果要改變中文字大小：
- 只需改變 chineseTextHeight 的比例（0.4 → 0.3 或 0.5）
- 不影響垂直間距
```

### 3. 自適應性

```
小屏幕（iPhone）：
- verticalSpacing = 744 × 0.03 = 22px
- chineseTextHeight = 80 × 0.4 = 32px

大屏幕（桌面）：
- verticalSpacing = 820 × 0.03 = 25px
- chineseTextHeight = 150 × 0.4 = 60px

都能自動適應屏幕大小
```

---

## 📋 對比表格

### 垂直間距 vs 中文字高度

| 項目 | verticalSpacing | chineseTextHeight |
|------|-----------------|-------------------|
| **計算基礎** | availableHeight | cardHeight |
| **公式** | × 0.03 | × 0.4 |
| **iPhone 14** | 22px | 32px |
| **桌面版** | 25px | 60px |
| **作用** | 卡片之間的距離 | 中文字框的高度 |
| **位置** | 卡片上下之間 | 英文卡片下方 |
| **影響** | 屏幕利用率 | 中文字可讀性 |

---

## 💡 關鍵理解

### verticalSpacing 的作用

```
verticalSpacing = 22.32px

作用：分隔卡片行
效果：
- 卡片之間有清晰的分隔
- 視覺效果整齊
- 易於點擊
- 屏幕利用率高
```

### chineseTextHeight 的作用

```
chineseTextHeight = 32px

作用：容納中文字
效果：
- 中文字有足夠的空間
- 中文字清晰可讀
- 卡片單元結構清晰
- 用戶體驗好
```

### 它們的關係

```
單元總高度 = cardHeight + chineseTextHeight + verticalSpacing
           = 80 + 32 + 22.32
           = 134.32px

這三個值共同決定了卡片的排列方式
```

---

## 📝 總結

### 為什麼 verticalSpacing 不是 32px？

| 原因 | 說明 |
|------|------|
| **計算基礎不同** | verticalSpacing 基於 availableHeight，chineseTextHeight 基於 cardHeight |
| **作用不同** | verticalSpacing 控制卡片間距，chineseTextHeight 控制中文字框大小 |
| **位置不同** | verticalSpacing 在卡片之間，chineseTextHeight 在英文卡片下方 |
| **獨立性** | 它們各自獨立計算，互不影響 |

### 如果 verticalSpacing 設為 32px 會怎樣？

```
❌ 卡片之間的距離會變大
❌ 可用於卡片的空間會減少
❌ 卡片尺寸會變小
❌ 屏幕利用率會降低
❌ 視覺效果會變差
```

### 正確的理解

```
verticalSpacing = 22.32px ✅
- 卡片之間的距離
- 基於可用高度的 3%

chineseTextHeight = 32px ✅
- 中文字框的高度
- 基於卡片高度的 40%

它們是兩個不同的概念，各自獨立計算
```

---

**版本**：v4.0
**分析日期**：2025-11-02
**文件**：IMPROVED_MIXED_MODE_LAYOUT_CALCULATION.md

