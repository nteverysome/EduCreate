<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <meta name="theme-color" content="#000000" />

    <link rel="manifest" href="/games/platformer-game/dist/manifest.json" />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Platformer PWA" />
    <meta name="apple-mobile-web-app-title" content="Platformer PWA" />
    <meta name="msapplication-starturl" content="/games/platformer-game/dist/" />

    <link rel="icon" type="image/png" sizes="192x192" href="/games/platformer-game/dist/assets/icons/icons-192.png" />
    <link rel="apple-touch-icon" type="image/png" sizes="192x192" href="/games/platformer-game/dist/assets/icons/icons-192.png" />

    <link rel="icon" type="image/png" sizes="512x512" href="/games/platformer-game/dist/assets/icons/icons-512.png" />
    <link rel="apple-touch-icon" type="image/png" sizes="512x512" href="/games/platformer-game/dist/assets/icons/icons-512.png" />

    <link rel="shortcut icon" href="/games/platformer-game/dist/favicon.ico" type="image/x-icon" />

    <title>Platformer PWA</title>
  </head>
  <body>
    <style>
      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background-color: #000000;
        overflow: hidden;
      }
      #phaser-game {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #phaser-game canvas {
        width: 100% !important;
        height: 100% !important;
        max-width: 100% !important;
        max-height: 100% !important;
        object-fit: contain !important;
        margin: 0 !important;
      }
      #loading-screen {
        position: fixed;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1;
        background-color: teal;
        user-select: none;
        transition: opacity 1s ease-in-out;
      }
      .transparent {
        opacity: 0;
      }
      h2 {
        font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        color: #ffffff;
      }
      /* Mobile responsive fixes */
      @media screen and (max-width: 768px) {
        #phaser-game canvas {
          width: 100vw !important;
          height: 100vh !important;
        }
      }
      @media screen and (orientation: portrait) {
        #phaser-game canvas {
          width: 100vw !important;
          height: auto !important;
          max-height: 100vh !important;
        }
      }
      @media screen and (orientation: landscape) {
        #phaser-game canvas {
          width: auto !important;
          height: 100vh !important;
          max-width: 100vw !important;
        }
      }
    </style>

    <noscript>Please enable javascript to continue using this application.</noscript>

    <div id="loading-screen">
      <h2 id="item">loading...</h2>
    </div>

    <div id="phaser-game"></div>

    <script>
      // var loadingScreen = document.getElementsByTagName('body')
      // loadingScreen[0].addEventListener('click', function(event) {
      //   event.preventDefault()
      //   console.log('click')
      // })
    </script>

    <script>
      // Check that service workers are registered
      if ('serviceWorker' in navigator) {
        // Use the window load event to keep the page load performant
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/games/platformer-game/dist/sw.js')
        })
      }
    </script>
    <script>
      // Override canvas styling for iframe compatibility
      function fixCanvasSize() {
        var canvas = document.querySelector('#phaser-game canvas');
        if (canvas) {
          // Get the actual container size
          var container = document.getElementById('phaser-game');
          var containerWidth = container.clientWidth || window.innerWidth;
          var containerHeight = container.clientHeight || window.innerHeight;

          // Calculate the aspect ratio (1280x720 = 16:9)
          var gameAspect = 1280 / 720;
          var containerAspect = containerWidth / containerHeight;

          var newWidth, newHeight;

          if (containerAspect > gameAspect) {
            // Container is wider than game - fit by height
            newHeight = containerHeight;
            newWidth = newHeight * gameAspect;
          } else {
            // Container is taller than game - fit by width
            newWidth = containerWidth;
            newHeight = newWidth / gameAspect;
          }

          // Apply the calculated size
          canvas.style.width = newWidth + 'px';
          canvas.style.height = newHeight + 'px';
          canvas.style.marginLeft = ((containerWidth - newWidth) / 2) + 'px';
          canvas.style.marginTop = ((containerHeight - newHeight) / 2) + 'px';
        }
      }

      // Run on load and resize
      window.addEventListener('load', function() {
        setTimeout(fixCanvasSize, 100);
        setTimeout(fixCanvasSize, 500);
        setTimeout(fixCanvasSize, 1000);
      });
      window.addEventListener('resize', fixCanvasSize);

      // Also listen for orientation changes on mobile
      window.addEventListener('orientationchange', function() {
        setTimeout(fixCanvasSize, 100);
        setTimeout(fixCanvasSize, 500);
      });
    </script>
  <script type="text/javascript" src="/games/platformer-game/dist/vendors.85a1f98c7d62ff6befde.js"></script><script type="text/javascript" src="/games/platformer-game/dist/game.1b621642e05b43878c38.js"></script></body>
</html>
