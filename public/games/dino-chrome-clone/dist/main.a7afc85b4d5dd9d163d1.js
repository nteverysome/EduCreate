"use strict";(self.webpackChunkdino=self.webpackChunkdino||[]).push([[792],{8229:(e,t,s)=>{var i=s(9645),n=s.n(i);const a={GAME:{WIDTH:{PORTRAIT:600,LANDSCAPE:1200},HEIGHT:350},SCENES:{BOOT:{NAME:"SCENE_BOOT"},GAME:{NAME:"SCENE_GAME",GAME:{SCORE:{MAX_LENGTH:5,COEFFICIENT:.02,POS:{X:{OFFSET:.95},Y:10},ACHIEVEMENT:{DISTANCE:100,FLASH:{DURATION:250,ITERATIONS:3}}},HIGH_SCORE:{STORAGE_KEY:"highScore",POS:{X:{OFFSET:15},Y:10},GAMEOVER:{FLASH:{DURATION:250,ITERATIONS:6}}},OBSTACLES:{TYPES:{BIRD:{FRAME:"bird",SPAWN:{SPEED:{MIN:12,MIN_MOBILE:10}}},CACTUS:{SMALL:{FRAME:"cactus-small",SIZING:{SPEED:{MIN:10,MIN_MOBILE:8}}},LARGE:{FRAME:"cactus-large",SIZING:{SPEED:{MIN:11,MIN_MOBILE:9}}}}},ACCELERATION:.001,SPEED:{INITIAL:10,MAX:17,MOBILE_COEFFICIENT:1.2},GAP:{MAX_MULIPLIER:1.5},SPAWN:{DELAY:3e3,MAX_DUPLICATION:2}}},GAMEOVER:{VIBRATION:200},RESTART:{COOLDOWN:750},INTRO:{STATES:{WAITING:"WAITING",ONGOING:"ONGOING",COMPLETE:"COMPLETE"},DURATION:400,CAMERA:{WIDTH:90}},NIGHTMODE:{DISTANCE:700,DURATION:12e3,FADE_DURATION:250,STARS:{MAX_COUNT:2}},STYLES:{TRANSITION:"width 250ms linear, height 250ms linear"}}},PREFABS:{PLAYER:{FRAMES:{INITIAL:"dino-idle-1",IDLING:["dino-idle-1","dino-idle-2"],RUNNING:["dino-run-1","dino-run-2"],DUCKING:["dino-duck-1","dino-duck-2"],JUMPING:"dino-idle-1",DEAD:"dino-dead"},POS:{INITIAL_X:0,X:50,Y:325},GRAVITY:{Y:2500},JUMP:{VELOCITY:{MAX:1500,START:-1350,SPEED_FALL:1125,INCREASE_INCREMENT:-75,INCREASE_THRESHOLD:-200},ACCELERATION:3200},BLINK:{DURATION:100,DELAY:7e3},STATES:{IDLING:"IDLING",RUNNING:"RUNNING",DUCKING:"DUCKING",JUMPING:"JUMPING",DEAD:"DEAD"}},OBSTACLES:{BIRD:{FRAMES:{INITIAL:"bird-1",FLYING:["bird-1","bird-2"]},POS:{Y:[225,250,275],Y_MOBILE:[225,275]},GAP:{MIN:120},SPEED:{OFFSET:[.8,-.8]}},CACTUS:{TYPES:["small","large"],SIZES:[1,2,3],POS:{Y:327},GAP:{MIN:100}}},GROUND:{POS:{X:0,Y:350},BODY:{OFFSET:{Y:25}}},CLOUD:{SPEED:2,POS:{Y:{MIN:100,MAX:200}},GAP:{MIN:200,MAX:500}},STAR:{FRAMES:["star-1","star-2","star-3"],SPEED:1.2,POS:{Y:{MIN:0,MAX:150}}},MOON:{FRAMES:["moon-7","moon-6","moon-5","moon-1","moon-4","moon-3","moon-2"],SPEED:1,POS:{Y:50}}},EVENTS:{GAME_START:"GAME_START",GAME_OVER:"GAME_OVER",GAME_RESTART:"GAME_RESTART",GAME_INTRO_START:"GAME_INTRO_START",GAME_INTRO_COMPLETE:"GAME_INTRO_COMPLETE",PLAYER_ACTION:"PLAYER_ACTION",ACHIEVEMENT:"ACHIEVEMENT",HIGH_SCORE_UPDATE:"HIGH_SCORE_UPDATE",HIGH_SCORE_FETCH:{REQUEST:"HIGH_SCORE_FETCH_REQUEST",SUCCESS:"HIGH_SCORE_FETCH_SUCCESS",FAIL:"HIGH_SCORE_FETCH_FAIL"},HIGH_SCORE_SAVE:{REQUEST:"HIGH_SCORE_SAVE_REQUEST",SUCCESS:"HIGH_SCORE_SAVE_SUCCESS",FAIL:"HIGH_SCORE_SAVE_FAIL"}}};class r{constructor(e){this.scene=e,this.cursors=this.scene.input.keyboard.createCursorKeys(),this.enterKey=this.scene.input.keyboard.addKey(n().Input.Keyboard.KeyCodes.ENTER),e.events.on(a.EVENTS.GAME_OVER,this.onGameOver,this)}update(){const{scene:e}=this;e.isInitialStart?this.isUpKeyPressed&&e.events.emit(a.EVENTS.GAME_START):e.isPlaying||(this.isEnterKeyJustUp&&e.events.emit(a.EVENTS.GAME_RESTART),e.readyToRestart&&this.isUpKeyJustUp&&e.events.emit(a.EVENTS.GAME_RESTART))}onGameOver(){const{scene:e}=this;e.time.delayedCall(r.CONFIG.RESTART.COOLDOWN,()=>{e.input.keyboard.resetKeys(),e.isPlaying||(e.readyToRestart=!0)})}get isUpKeyPressed(){const{activePointer:e}=this.scene.input;return this.cursors.up.isDown||this.cursors.space.isDown||e.isDown&&e.wasTouch}get isUpKeyJustUp(){return n().Input.Keyboard.JustUp(this.cursors.up)||n().Input.Keyboard.JustUp(this.cursors.space)}get isEnterKeyJustUp(){return n().Input.Keyboard.JustUp(this.enterKey)}}var o,h,c;o=r,h="CONFIG",c=a.SCENES.GAME,h in o?Object.defineProperty(o,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[h]=c;const E=r,l=class{constructor(e){this.scene=e,this.playerAction=e.sound.add("player-action"),this.achievement=e.sound.add("achievement"),this.gameover=e.sound.add("gameover"),e.events.on(a.EVENTS.PLAYER_ACTION,this.playPlayerAction,this),e.events.on(a.EVENTS.ACHIEVEMENT,this.playAchievement,this),e.events.on(a.EVENTS.GAME_OVER,this.playGameOver,this)}playPlayerAction(){this.playerAction.play()}playAchievement(){this.achievement.play()}playGameOver(){this.gameover.play()}};class S{constructor(e,{canvas:t,camera:s,gameSpeed:i,gameObjects:n}){this.game=e.game,this.canvas=e.game.canvas,this.scale=e.scale,this.callbacks={canvas:t,camera:s,gameSpeed:i,gameObjects:n},this.gameWidth=this.scale.gameSize.width,this.scale.on("resize",()=>this.resize(this.scale.gameSize,this.scale.parentSize))}resize(e,t){this.resizeCanvas(e,t),this.resizeGameSpeed(e),this.resizeCamera(e),this.resizeGameObjects(e)}resizeCanvas(e,t){const{width:s,height:i}=this.callbacks.canvas({width:t.width,height:e.height*(t.width/e.width)});this.canvas.style.width="".concat(s,"px"),this.canvas.style.height="".concat(i,"px")}resizeGameSpeed(e){this.gameWidth!==e.width&&this.callbacks.gameSpeed(e),this.gameWidth=e.width}resizeCamera(e){this.callbacks.camera(e)}resizeGameObjects(e){this.callbacks.gameObjects(e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(S,"CONFIG",a.SCENES.GAME);const d=S;s(4602);const O=class{constructor(e){this.eventEmitter=e}async getHighScore(){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_FETCH.REQUEST)}onGetSuccess(e){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_FETCH.SUCCESS,e)}onGetFail(){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_FETCH.FAIL)}async saveHighScore(){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_SAVE.REQUEST)}onSaveSuccess(e){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_SAVE.SUCCESS,e)}onSaveFail(){this.eventEmitter.emit(a.EVENTS.HIGH_SCORE_SAVE.FAIL)}};function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class I extends O{constructor(...e){super(...e),u(this,"storage",window.localStorage)}async getHighScore(){super.getHighScore();try{const{STORAGE_KEY:e}=I.CONFIG;null===this.storage.getItem(e)&&this.resetHighScore();const t=Number.parseInt(this.storage.getItem(e),10)||0;return this.onGetSuccess(t),t}catch(e){throw this.onGetFail(),e}}async saveHighScore(e=0){super.saveHighScore();try{return this.storage.setItem(I.CONFIG.STORAGE_KEY,e),this.onSaveSuccess(e),e}catch(e){throw this.onSaveFail(),e}}}u(I,"CONFIG",{STORAGE_KEY:a.SCENES.GAME.GAME.HIGH_SCORE.STORAGE_KEY});const N=I;s(789);const A=(e="token")=>{const t=new URLSearchParams(window.location.search);return t.has(e)?t.get(e):void 0};function p(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,i)}return s}function T(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}s(3396);const m=(e,t=0,s={})=>{let{signal:i}=s,n=function(e,t){if(null==e)return{};var s,i,n=function(e,t){if(null==e)return{};var s,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)s=a[i],t.indexOf(s)>=0||(n[s]=e[s]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)s=a[i],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}(s,["signal"]);const a=new AbortController,r=fetch(e,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?p(Object(s),!0).forEach(function(t){T(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}({signal:a.signal},n));i&&i.addEventListener("abort",()=>a.abort());const o=setTimeout(()=>a.abort(),t);return r.finally(()=>clearTimeout(o))};function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const G=class extends O{constructor(...e){super(...e),g(this,"API_ENDPOINT",null),g(this,"token",A())}async getHighScore(){super.getHighScore();try{const e=await m("".concat(this.API_ENDPOINT),3e3,{headers:{Authorization:"Bearer ".concat(this.token)}}),t=await e.json();if(!1===t.ok)throw new Error(t.message);const s=t.userScore?t.userScore.score:0;return this.onGetSuccess(s),s}catch(e){throw this.onGetFail(),e}}async saveHighScore(e){super.saveHighScore();try{const t=await m("".concat(this.API_ENDPOINT),3e3,{method:"POST",headers:{Authorization:"Bearer ".concat(this.token),"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({score:e})}),s=await t.json();if(!1===s.ok)throw new Error(s.message);return this.onSaveSuccess(s.score),s.score}catch(e){throw this.onSaveFail(),e}}};class C{constructor(e){this.scene=e,this.isFlashing=!1,this.flashTween=this.createFlashTween(),this.maxScoreLength=C.CONFIG.MAX_LENGTH,this.maxScore=10**(this.maxScoreLength-1)-1,this.defaultString="",this.scene.events.on(a.EVENTS.GAME_START,this.onStart,this),this.scene.events.on(a.EVENTS.GAME_RESTART,this.onRestart,this),this.scene.events.on(a.EVENTS.GAME_OVER,this.onGameOver,this),this.createScoreText()}createScoreText(){throw new Error("Method must be implemented by subclass")}createFlashTween(e,t,s=()=>{},i=()=>{}){return this.scene.tweens.create({targets:this.scoreText,duration:0,alpha:{start:1,to:.01},repeat:t,repeatDelay:e,yoyo:!0,hold:e,completeDelay:e,onStart:()=>{this.isFlashing=!0,s()},onComplete:()=>{this.isFlashing=!1,this.scoreText.setAlpha(1),i()}})}update(e){e>=this.maxScore&&(this.maxScoreLength+=1,this.maxScore=10**(this.maxScoreLength-1)-1)}setScore(e){const t=this.defaultString+e.toString().padStart(this.maxScoreLength,"0");this.scoreText.setText(t)}clearScore(){this.setScore(0)}flashScore(){this.flashTween=this.createFlashTween(),this.flashTween.play()}reset(){this.flashTween.complete()}onStart(){}onRestart(){this.isFlashing=!1,this.flashTween=this.createFlashTween(),this.maxScoreLength=C.CONFIG.MAX_LENGTH,this.maxScore=10**(this.maxScoreLength-1)-1}onGameOver(){this.reset()}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(C,"CONFIG",a.SCENES.GAME.GAME.SCORE);const R=C;class M extends R{createScoreText(){this.scoreText=this.scene.add.bitmapText(0,0,"joystix","",32).setOrigin(1,0).setDepth(9999)}createFlashTween(){const{DURATION:e,ITERATIONS:t}=M.CONFIG.ACHIEVEMENT.FLASH;return super.createFlashTween(e,t)}update(e,t){super.update(t),e&&t>0&&t%M.CONFIG.DISTANCE===0&&!this.isFlashing&&(this.scene.events.emit(a.EVENTS.ACHIEVEMENT),this.flashScore()),e&&!this.isFlashing&&this.setScore(t)}onGameOver(e){super.onGameOver(),this.setScore(e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(M,"CONFIG",a.SCENES.GAME.GAME.SCORE);const F=M;class b extends R{constructor(e,t=!1){super(e),this.scene=e,this.defaultString="HI ",this.scene.events.on(a.EVENTS.HIGH_SCORE_FETCH.SUCCESS,this.onFetchScore,this),this.scene.events.on(a.EVENTS.HIGH_SCORE_SAVE.SUCCESS,this.onSaveScore,this),t||this.scoreText.on("pointerdown",this.onClick,this)}createScoreText(){this.scoreText=this.scene.add.bitmapText(0,0,"joystix","",32).setTintFill(7697781).setOrigin(1,0).setDepth(9999)}createFlashTween(){const{DURATION:e,ITERATIONS:t}=b.CONFIG.GAMEOVER.FLASH;return super.createFlashTween(e,t,()=>this.scoreText.clearTint(),()=>this.scoreText.setTintFill(7697781))}onFetchScore(e){this.setScore(e)}onSaveScore(e){this.setScore(e)}onClick(){this.isFlashing?(this.reset(),this.scoreText.disableInteractive(),this.scene.events.emit(a.EVENTS.HIGH_SCORE_UPDATE,0)):this.flashScore()}onRestart(){this.reset(),this.scoreText.disableInteractive(),super.onRestart()}onGameOver(){super.onGameOver();const{width:e,height:t}=this.scoreText;this.scoreText.setInteractive({hitArea:new(n().Geom.Rectangle)(0,0,e,t)})}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(b,"CONFIG",a.SCENES.GAME.GAME.HIGH_SCORE);const y=b,P=class{constructor(e,t){this.currentScorePanel=e,this.highScorePanel=t}adjustPosition({width:e}){const{scoreText:t}=this.currentScorePanel,{scoreText:s}=this.highScorePanel,i=e*F.CONFIG.POS.X.OFFSET,n=F.CONFIG.POS.Y;t.setPosition(i,n);const a=i-t.width-y.CONFIG.POS.X.OFFSET,r=y.CONFIG.POS.Y;s.setPosition(a,r)}update(e){this.adjustPosition(e)}resize(e){this.adjustPosition(e)}},w=class{constructor(e){const t=e.scale.gameSize.width,s=e.scale.gameSize.height;this.scene=e,this.zone=e.add.zone().setOrigin(0,0),this.gameOverText=e.add.bitmapText(t/2,s/2-75,"joystix","G A M E  O V E R",32).setOrigin(.5,.5).setDepth(9999).setVisible(!1),this.restartImg=e.add.image(t/2,s/2,"dino","restart").setOrigin(.5,.5).setDepth(9999).setVisible(!1),this.scene.events.on(a.EVENTS.GAME_OVER,this.show,this),this.scene.events.on(a.EVENTS.GAME_RESTART,this.hide,this),this.zone.on("pointerdown",this.onClick,this),this.zone.on("pointerup",this.onClick,this)}onClick(e){e.wasTouch&&!e.noButtonDown()||this.scene.events.emit(a.EVENTS.GAME_RESTART)}show(){const{x:e,y:t,width:s,height:i}=this.gameOverText,{bottom:n}=this.restartImg.getBounds();this.gameOverText.setVisible(!0),this.restartImg.setVisible(!0),this.zone.setX(e-s/2),this.zone.setY(t-i/2),this.zone.setSize(s,n-(t-i/2)),this.zone.setInteractive()}hide(){this.gameOverText.setVisible(!1),this.restartImg.setVisible(!1),this.zone.disableInteractive()}resize(e){this.gameOverText.setX(e.width/2),this.restartImg.setX(e.width/2);const{x:t,y:s,width:i,height:n}=this.gameOverText;this.zone.setPosition(t-i/2,s-n/2)}},v=()=>Boolean(window.TelegramGameProxy&&A()),f=class{constructor(e){this.scene=e,this.gameOverPanel=new w(e),this.currentScorePanel=new F(e),this.highScorePanel=new y(e,v()),this.scoreZone=new P(this.currentScorePanel,this.highScorePanel)}update(e,t,s){this.currentScorePanel.update(e,s),this.highScorePanel.update(s),this.scoreZone.update(t)}resize(e){this.scoreZone.resize(e),this.gameOverPanel.resize(e)}};class D{constructor(e){this.eventEmitter=e,this.setState(D.CONFIG.STATES.WAITING)}start(){this.setState(D.CONFIG.STATES.ONGOING),this.eventEmitter.emit(a.EVENTS.GAME_INTRO_START)}complete(){this.setState(D.CONFIG.STATES.COMPLETE),this.eventEmitter.emit(a.EVENTS.GAME_INTRO_COMPLETE)}setState(e){if(Object.hasOwnProperty.call(D.CONFIG.STATES,e))return this.state=e,this;throw new Error("Invalid Intro State: ".concat(e))}get isWaiting(){return this.state===D.CONFIG.STATES.WAITING}get isOngoing(){return this.state===D.CONFIG.STATES.ONGOING}get isComplete(){return this.state===D.CONFIG.STATES.COMPLETE}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(D,"CONFIG",a.SCENES.GAME.INTRO);const _=D;class L{constructor(e){this.player=e,this.scene=e.scene,this.scene.physics.world.enable(e),e.setCollideWorldBounds(!0),e.setGravityY(2*L.CONFIG.GRAVITY.Y),e.setAccelerationY(L.CONFIG.JUMP.ACCELERATION),e.setMaxVelocity(0,L.CONFIG.JUMP.VELOCITY.MAX)}get isOnFloor(){return this.player.body.onFloor()}jump(){if(this.isOnFloor)return void this.player.setVelocityY(L.CONFIG.JUMP.VELOCITY.START);const{INCREASE_THRESHOLD:e,INCREASE_INCREMENT:t}=L.CONFIG.JUMP.VELOCITY,s=this.player.body.velocity.y;s<e&&this.player.setVelocityY(s+t)}speedFall(){this.player.setVelocityY(L.CONFIG.JUMP.VELOCITY.SPEED_FALL)}reset(){this.player.setVelocityY(0)}resizeBodyToMatchFrame(e){const{name:t,width:s,height:i}=e;if(t===L.CONFIG.FRAMES.JUMPING||L.CONFIG.FRAMES.IDLING.includes(t)||L.CONFIG.FRAMES.RUNNING.includes(t)){const e=15,t=25,n=4;this.player.setBodySize(s-e-t,i-n),this.player.body.setOffset(t,n)}else if(L.CONFIG.FRAMES.DUCKING.includes(t)){const e=35,t=25,n=6;this.player.setBodySize(s-e-t,i-n),this.player.body.setOffset(t,n)}}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(L,"CONFIG",a.PREFABS.PLAYER);const H=L,x=class{constructor(e){this.player=e,this.scene=e.scene,this.cursors=e.scene.input.keyboard.createCursorKeys()}update(){const{player:e}=this;e.isDead||(e.isOnFloor?this.isDuckKeyPressed?e.duck():this.isJumpKeyPressed?e.jump():e.run():e.isOnFloor||(this.isDuckKeyPressed?e.speedFall():this.isJumpKeyPressed?e.jump():e.idle()))}get isDuckKeyPressed(){return this.cursors.down.isDown}get isJumpKeyPressed(){const{activePointer:e}=this.scene.input;return this.cursors.up.isDown||this.cursors.space.isDown||e.isDown&&e.wasTouch}};function z(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class U{constructor(e){z(this,"randomizeidleAnimation",e=>{const{BLINK:t}=U.CONFIG,s=e.getFrameAt(0),i=e.getFrameAt(1);s.duration=n().Math.RND.between(0,t.DELAY),i.duration=-1*e.msPerFrame+t.DURATION}),this.player=e,this.initAnimations(),e.on("animationstart",this.onAnimationEvents,this),e.on("animationupdate",this.onAnimationEvents,this),e.on("animationcomplete",this.onAnimationEvents,this),e.on("animationstart-idle",this.randomizeidleAnimation,this),e.on("animationrepeat-idle",this.randomizeidleAnimation,this)}initAnimations(){const{scene:e}=this.player,t=e.anims.generateFrameNames("dino",{frames:U.CONFIG.FRAMES.IDLING});e.anims.create({key:"idle",frames:t,frameRate:1,repeat:-1});const s=e.anims.generateFrameNames("dino",{frames:U.CONFIG.FRAMES.RUNNING});e.anims.create({key:"run",frames:s,frameRate:10,repeat:-1});const i=e.anims.generateFrameNames("dino",{frames:U.CONFIG.FRAMES.DUCKING});e.anims.create({key:"duck",frames:i,frameRate:10,repeat:-1})}update(){const{STATES:e,FRAMES:t}=U.CONFIG,{player:s}=this;switch(s.state){case e.IDLING:s.anims.play("idle",!0);break;case e.RUNNING:s.anims.play("run",!0);break;case e.DUCKING:s.anims.play("duck",!0);break;case e.DEAD:s.anims.stop(),s.setFrame(t.DEAD);break;case e.JUMPING:default:s.anims.stop(),s.setFrame(t.JUMPING),s.resizeBodyToMatchFrame(s.frame)}}onAnimationEvents(e,t){this.player.resizeBodyToMatchFrame(t.frame)}}z(U,"CONFIG",a.PREFABS.PLAYER);const V=U;class B extends n().Physics.Arcade.Sprite{constructor(e,t=B.CONFIG.POS.INITIAL_X,s=B.CONFIG.POS.Y){super(e,t,s,"dino",B.CONFIG.FRAMES.INITIAL),this.isInitialJump=!0,this.physicsManager=new H(this),this.inputManager=new x(this),this.animationManager=new V(this),this.setOrigin(0,1),this.setDepth(1e3),this.scene.events.on(a.EVENTS.GAME_INTRO_START,this.onIntroStart,this),this.scene.events.on(a.EVENTS.GAME_RESTART,this.reset,this),this.scene.events.on(a.EVENTS.GAME_OVER,this.die,this),this.idle(),this.animationManager.update(),this.scene.add.existing(this)}update(){this.scene.intro.isWaiting&&this.isOnFloor&&(this.isRunning||this.isDucking)&&this.scene.intro.start(),this.inputManager.update(),this.animationManager.update()}onIntroStart(){this.scene.tweens.add({targets:this,duration:a.SCENES.GAME.INTRO.DURATION,x:B.CONFIG.POS.X,onComplete:()=>{this.scene.intro.complete()}})}idle(){this.setState(B.CONFIG.STATES.IDLING)}run(){this.setState(B.CONFIG.STATES.RUNNING)}duck(){this.setState(B.CONFIG.STATES.DUCKING)}jump(){this.isOnFloor&&!this.isInitialJump&&this.scene.intro.isWaiting?this.run():(this.isInitialJump=!1,this.setState(B.CONFIG.STATES.JUMPING),this.physicsManager.jump(),!this.scene.intro.isWaiting&&this.isOnFloor&&this.scene.events.emit(a.EVENTS.PLAYER_ACTION))}speedFall(){this.physicsManager.speedFall()}die(){this.setState(B.CONFIG.STATES.DEAD),this.animationManager.update(),this.physicsManager.reset(),this.setY(this.y-4)}reset(){this.setState(B.CONFIG.STATES.IDLING),this.animationManager.update(),this.setY(B.CONFIG.POS.Y)}get isIdling(){return this.state===B.CONFIG.STATES.IDLING}get isRunning(){return this.state===B.CONFIG.STATES.RUNNING}get isDucking(){return this.state===B.CONFIG.STATES.DUCKING}get isJumping(){return this.state===B.CONFIG.STATES.JUMPING}get isDead(){return this.state===B.CONFIG.STATES.DEAD}get isOnFloor(){return this.physicsManager.isOnFloor}setState(e){if(Object.hasOwnProperty.call(B.CONFIG.STATES,e))return this.state=e,this;throw new Error("Invalid Player State: ".concat(e))}resizeBodyToMatchFrame(e){this.physicsManager.resizeBodyToMatchFrame(e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(B,"CONFIG",a.PREFABS.PLAYER);const Y=B;class j extends n().GameObjects.TileSprite{constructor(e,t=j.CONFIG.POS.X,s=j.CONFIG.POS.Y){super(e,t,s,0,0,"dino","ground");const i=this.scene.scale;this.setY(i.height),this.setOrigin(0,2),this.setSize(i.width,this.height),this.scene.physics.world.enable(this,n().Physics.Arcade.STATIC_BODY),this.body.setOffset(0,j.CONFIG.BODY.OFFSET.Y),this.scene.add.existing(this)}update(e){this.move(e)}move(e){this.tilePositionX+=e}resize({width:e}){this.width=e,this.body.width=e}reset(){this.tilePositionX=0}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(j,"CONFIG",a.PREFABS.GROUND);const k=j;class X extends n().Physics.Arcade.Group{constructor(e){super(e.physics.world,e)}update(e,t){const{width:s}=this.scene.scale.gameSize;this.children.each(t=>t.update(e));const i=this.getLast(!0);i&&i.x+i.width+i.gap<s&&(this.clearItems(),this.spawnItem(e,t))}spawnItem(e,t){throw new Error("Method must be implemented by subclass")}clearItems(){this.children.each(e=>{e.visible||e.die()})}reset(){this.children.each(e=>e.reset()),this.clear(!0,!0)}}const K=X;class W extends n().Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,"dino",i),this.gap=0,this.setOrigin(0,1),this.setDepth(900),this.scene.events.on(a.EVENTS.GAME_OVER,this.freeze,this),this.scene.add.existing(this)}update(e){this.move(e),this.x+this.width<0&&this.setVisible(!1)}move(e){this.x-=e}setGap(e){this.gap=e}freeze(){this.scene.events.off(a.EVENTS.GAME_OVER,this.freeze)}die(){this.freeze(),this.destroy()}reset(){this.die()}}const J=W,Z=class extends J{update(e){super.update(e),this.setBodySize(this.width-4,this.height-2),this.body.setOffset(2,2)}};class Q{constructor(e){this.bird=e;const t=e.scene.anims.generateFrameNames("dino",{frames:Q.CONFIG.FRAMES.FLYING});e.scene.anims.create({key:"fly",frames:t,frameRate:6,repeat:-1}),e.on("animationstart",this.resizeBodyOnAnim,this),e.on("animationupdate",this.resizeBodyOnAnim,this)}update(){this.bird.anims.play("fly",!0)}stop(){this.bird.anims.stop()}resizeBodyOnAnim(e,t){const{name:s}=t.frame;if(s===Q.CONFIG.FRAMES.FLYING[0]){const e=12;this.bird.setBodySize(76,44),this.bird.body.setOffset(12,e+12)}else s===Q.CONFIG.FRAMES.FLYING[1]&&(this.bird.setBodySize(76,44),this.bird.body.setOffset(12,12))}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Q,"CONFIG",a.PREFABS.OBSTACLES.BIRD);const $=Q;class q extends J{constructor(e,t,s){super(e,t,s,q.CONFIG.FRAMES.INITIAL),this.animationManager=new $(this),this.speedOffset=n().Math.RND.pick(q.CONFIG.SPEED.OFFSET)}update(e){this.animationManager.update(),super.update(e)}move(e){this.x-=e+this.speedOffset}freeze(){super.freeze(),this.animationManager.stop()}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(q,"CONFIG",a.PREFABS.OBSTACLES.BIRD);const ee=q;class te extends K{constructor(e){super(e),this.obstacleHistory=[]}checkDuplication(e,t){return!this.obstacleHistory.some(t=>t.FRAME!==e.FRAME)&&this.obstacleHistory.length>=t}spawnItem(e,t){const{MAX_DUPLICATION:s}=te.CONFIG,{BIRD:i,CACTUS:r}=te.CONFIG.TYPES;let o;if(o=e>i.SPAWN.SPEED.MIN?n().Math.RND.pick([i,r.SMALL,r.LARGE]):n().Math.RND.pick([r.SMALL,r.LARGE]),this.checkDuplication(o,s))this.spawnItem(e,t);else if(this.obstacleHistory.push(o),this.obstacleHistory.length>s&&(this.obstacleHistory=this.obstacleHistory.slice(-s)),o===i)this.spawnBird(e,t);else{let s=1;e>(t?o.SIZING.SPEED.MIN_MOBILE:o.SIZING.SPEED.MIN)&&(s=n().Math.RND.pick(a.PREFABS.OBSTACLES.CACTUS.SIZES)),this.spawnCactus(e,t,"".concat(o.FRAME,"-").concat(s))}}spawnBird(e,t){const{width:s}=this.scene.scale.gameSize,{BIRD:i}=a.PREFABS.OBSTACLES,r=t?n().Math.RND.pick(i.POS.Y_MOBILE):n().Math.RND.pick(i.POS.Y),o=new ee(this.scene,s,r);this.add(o);const h=this.getGap(e,i.GAP.MIN,o.width);o.setGap(h)}spawnCactus(e,t,s){const{width:i}=this.scene.scale.gameSize,{CACTUS:n}=a.PREFABS.OBSTACLES,r=new Z(this.scene,i,n.POS.Y,s);this.add(r);const o=this.getGap(e,n.GAP.MIN,r.width);r.setGap(o)}getGap(e,t,s){const{MAX_MULIPLIER:i}=te.CONFIG.GAP,a=Math.round(s*e+t),r=Math.round(a*i);return n().Math.RND.between(a,r)}reset(){super.reset(),this.obstacleHistory=[]}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(te,"CONFIG",{TYPES:a.SCENES.GAME.GAME.OBSTACLES.TYPES,MAX_DUPLICATION:a.SCENES.GAME.GAME.OBSTACLES.SPAWN.MAX_DUPLICATION,GAP:a.SCENES.GAME.GAME.OBSTACLES.GAP});const se=te;class ie extends n().GameObjects.Image{constructor(e,t,s){super(e,t,s,"dino","cloud"),this.gap=0,this.setOrigin(0,0),this.setDepth(300),this.scene.add.existing(this)}update(e){this.move(e),this.x+this.width<0&&this.setVisible(!1)}move(e){this.x-=e}setGap(e){this.gap=e}die(){this.destroy()}}const ne=ie;class ae extends K{spawnItem(){const{width:e}=this.scene.scale.gameSize,t=ae.CONFIG,s=n().Math.RND.between(t.POS.Y.MIN,t.POS.Y.MAX),i=n().Math.RND.between(t.GAP.MIN,t.GAP.MAX),a=new ne(this.scene,e,s);a.setGap(i),this.add(a)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(ae,"CONFIG",a.PREFABS.CLOUD);const re=ae;class oe extends n().GameObjects.Image{constructor(e,t,s,i=n().Math.RND.pick(oe.CONFIG.FRAMES)){super(e,t,s,"dino",i),this.setOrigin(0,0),this.setDepth(100),this.scene.add.existing(this)}update(e){this.move(e)}move(e){this.x-=e}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(oe,"CONFIG",a.PREFABS.STAR);const he=oe;class ce extends n().GameObjects.Group{constructor(e){super(e),this.scene.add.existing(this)}update(e){const{width:t}=this.scene.scale.gameSize;this.children.each(s=>{s.update(e),s.x+s.width<0&&(s.setPosition(t,this.getRandomYPos()),s.setFrame(this.getRandomFrame()))})}spawnItems(){const{MAX_COUNT:e}=a.SCENES.GAME.NIGHTMODE.STARS;for(let t=this.getLength();t<e;t+=1)this.add(new he(this.scene));this.shuffleItems()}shuffleItems(){const{width:e}=this.scene.scale.gameSize,{MAX_COUNT:t}=a.SCENES.GAME.NIGHTMODE.STARS,s=e/t;this.children.each((e,t)=>{const i=this.getRandomFrame(),n=this.getRandomXPos(s,t),a=this.getRandomYPos();e.setPosition(n,a),e.setFrame(i)})}getRandomFrame(){return n().Math.RND.pick(ce.CONFIG.FRAMES)}getRandomXPos(e,t){return n().Math.RND.between(e*t,e*(t+1))}getRandomYPos(){const{MIN:e,MAX:t}=ce.CONFIG.POS.Y;return n().Math.RND.between(e,t)}reset(){this.clear(!0,!0)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(ce,"CONFIG",a.PREFABS.STAR);const Ee=ce;class le extends n().GameObjects.Image{constructor(e,t,s,i=le.CONFIG.FRAMES[0]){super(e,t,s,"dino",i),this.phase=0,this.setOrigin(0,0),this.setDepth(200),this.scene.add.existing(this)}update(e){this.move(e)}move(e){this.x-=e}setPhase(e){e>=le.CONFIG.FRAMES.length?this.phase=0:this.phase=e,this.setFrame(le.CONFIG.FRAMES[this.phase])}nextPhase(){this.setPhase(this.phase+1)}reset(){this.setPhase(0)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(le,"CONFIG",a.PREFABS.MOON);const Se=le;class de{constructor(e){const{FADE_DURATION:t}=de.CONFIG.NIGHTMODE,s=e.scale.gameSize.width;this.scene=e,this.isEnabled=!1,this.moon=new Se(e,s-50,de.CONFIG.MOON.POS.Y),this.moon.setAlpha(0),this.stars=new Ee(e),this.stars.spawnItems(),this.stars.children.each(e=>e.setAlpha(0)),this.canvas=e.game.canvas,this.parent=e.game.scale.parent,this.canvas.style.transition="filter ".concat(t,"ms linear"),this.parent.style.transition="background-color ".concat(t,"ms linear")}update(){const{width:e}=this.scene.scale.gameSize,{moon:t,stars:s}=this;this.isEnabled&&(t.update(de.CONFIG.MOON.SPEED),s.update(de.CONFIG.STARS.SPEED),t.x+t.width<0&&t.setX(e))}get isEnabled(){return this.enabled}set isEnabled(e){this.enabled=e}enable(){this.stars.shuffleItems(),this.scene.tweens.add({targets:[this.moon,...this.stars.getChildren()],duration:de.CONFIG.NIGHTMODE.FADE_DURATION,alpha:1,onStart:()=>{this.isEnabled=!0,this.canvas.style.filter="invert(1)",this.parent.style.backgroundColor="#000"}})}disable(e=()=>{}){this.scene.tweens.add({targets:[this.moon,...this.stars.getChildren()],duration:de.CONFIG.NIGHTMODE.FADE_DURATION,alpha:0,onStart:()=>{this.canvas.style.filter="invert(0)",this.parent.style.backgroundColor="#fff"},onComplete:()=>{this.isEnabled=!1,this.moon.nextPhase(),e()}})}reset(){this.disable(()=>this.moon.reset())}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(de,"CONFIG",{NIGHTMODE:a.SCENES.GAME.NIGHTMODE,MOON:a.PREFABS.MOON,STARS:a.PREFABS.STAR});const Oe=de;class ue{constructor(e){this.scene=e,this.ground=new k(e),this.obstacles=new se(e),this.clouds=new re(e),this.nightMode=new Oe(e),this.scene.events.on(a.EVENTS.GAME_INTRO_COMPLETE,this.start,this),this.scene.events.on(a.EVENTS.GAME_RESTART,this.reset,this)}start(){const{speed:e}=this.scene;this.spawnInitialCloud(e),this.spawnInitialObstacle(e)}spawnInitialCloud(e){this.clouds.spawnItem(e)}spawnInitialObstacle(e,t){const s=ue.CONFIG.OBSTACLES.SPAWN.DELAY;this.scene.time.delayedCall(s,()=>this.obstacles.spawnItem(e,t))}update(e,t){this.ground.update(e),this.obstacles.update(e,t),this.clouds.update(ue.CONFIG.CLOUDS.SPEED),this.nightMode.update()}reset(){const{speed:e}=this.scene;this.ground.reset(),this.obstacles.reset(),this.nightMode.reset(),this.spawnInitialObstacle(e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(ue,"CONFIG",{OBSTACLES:a.SCENES.GAME.GAME.OBSTACLES,CLOUDS:a.PREFABS.CLOUD});const Ie=ue;class Ne extends n().Scene{constructor(){super(Ne.CONFIG.NAME)}init(){this.isInitialStart=!0,this.isPlaying=!1,this.readyToRestart=!1,this.speed=0,this.maxSpeed=0,this.initSpeed(),this.distance=0,this.highScore=0,this.soundManager=new l(this),this.inputManager=new E(this),this.resizeManager=new d(this,{canvas:this.onResizeCanvas.bind(this),camera:this.onResizeCamera.bind(this),gameSpeed:this.onResizeGameSpeed.bind(this),gameObjects:this.onResizeGameObjects.bind(this)}),this.scoreManager=v()?new G(this.events):new N(this.events),this.events.on(a.EVENTS.GAME_START,this.onGameStart,this),this.events.on(a.EVENTS.GAME_INTRO_START,this.onIntroStart,this),this.events.on(a.EVENTS.GAME_INTRO_COMPLETE,this.onIntroComplete,this),this.events.on(a.EVENTS.GAME_RESTART,this.onGameRestart,this),this.events.on(a.EVENTS.GAME_OVER,this.onGameOver,this),this.events.on(a.EVENTS.HIGH_SCORE_UPDATE,this.onHighScoreUpdate,this)}initSpeed(){const{width:e}=this.scale.gameSize,{INITIAL:t,MAX:s,MOBILE_COEFFICIENT:i}=Ne.CONFIG.GAME.OBSTACLES.SPEED;e===a.GAME.WIDTH.LANDSCAPE?(this.speed=t,this.maxSpeed=s):e===a.GAME.WIDTH.PORTRAIT&&(this.speed=t/i,this.maxSpeed=s/i)}create(){this.ui=new f(this),this.intro=new _(this.events),this.player=new Y(this),this.horizon=new Ie(this),this.ground=this.horizon.ground,this.obstacles=this.horizon.obstacles,this.nightMode=this.horizon.nightMode,this.physics.add.collider(this.player,this.ground),this.physics.add.overlap(this.player,this.obstacles,this.onPlayerHitObstacle,null,this),this.resizeManager.resize(this.scale.gameSize,this.scale.parentSize),this.scoreManager.getHighScore().then(e=>{this.highScore=e}).catch(()=>{})}update(){const{gameSize:e}=this.scale,t=e.width===a.GAME.WIDTH.PORTRAIT;if(this.inputManager.update(),this.ui.update(this.isPlaying,e,this.score),this.isPlaying&&(this.player.update(),this.intro.isComplete)){const{GAME:e,NIGHTMODE:s}=Ne.CONFIG,{OBSTACLES:i}=e;this.speed<this.maxSpeed?this.speed+=i.ACCELERATION:this.speed=this.maxSpeed,this.distance+=this.speed,this.shouldNightModeStart&&(this.nightMode.enable(),this.time.delayedCall(s.DURATION,()=>{this.isPlaying&&this.nightMode.isEnabled&&this.nightMode.disable()})),this.horizon.update(this.speed,t)}}onPlayerHitObstacle(){this.events.emit(a.EVENTS.GAME_OVER,this.score,this.highScore)}onGameStart(){this.isPlaying=!0,this.isInitialStart=!1,this.ui.highScorePanel.setScore(this.highScore)}onIntroStart(){const{width:e}=this.scale.gameSize;this.tweens.add({targets:this.cameras.main,duration:Ne.CONFIG.INTRO.DURATION,width:e})}onIntroComplete(){const{canvas:e,gameSize:t,parentSize:s}=this.scale,i=e.style.transition,n="".concat(a.SCENES.GAME.STYLES.TRANSITION,", ").concat(i);e.style.transition=n,this.resizeManager.resizeCanvas(t,s),e.addEventListener("transitionend",()=>{e.style.transition=i,this.resizeManager.resizeCanvas(t,s)})}onGameRestart(){this.isPlaying=!0,this.readyToRestart=!1,this.distance=0,this.speed=0,this.maxSpeed=0,this.initSpeed(),this.physics.resume(),this.scoreManager.getHighScore().then(e=>{this.highScore=e}).catch(()=>{})}onGameOver(){const{width:e,height:t}=this.scale.gameSize;this.isPlaying=!1,this.physics.pause(),this.scale.resize(e,t),this.game.device.features.vibration&&navigator.vibrate(Ne.CONFIG.GAMEOVER.VIBRATION),this.score>this.highScore&&this.events.emit(a.EVENTS.HIGH_SCORE_UPDATE,this.score)}onHighScoreUpdate(e){this.scoreManager.saveHighScore(e).then(()=>{this.highScore=e}).catch(()=>{})}get score(){return Math.ceil(this.distance*Ne.CONFIG.GAME.SCORE.COEFFICIENT)}get shouldNightModeStart(){const{score:e,nightMode:t}=this,{DISTANCE:s}=Ne.CONFIG.NIGHTMODE;return e>0&&e%s===0&&!t.isEnabled}onResizeCanvas(e){const{width:t,height:s}=e;return this.intro.isComplete?{width:t,height:s}:{width:.8*t,height:.8*s}}onResizeGameSpeed(e){const{MAX:t,MOBILE_COEFFICIENT:s}=Ne.CONFIG.GAME.OBSTACLES.SPEED;e.width===a.GAME.WIDTH.LANDSCAPE?(this.speed*=s,this.maxSpeed=t):e.width===a.GAME.WIDTH.PORTRAIT&&(this.speed/=s,this.maxSpeed=t/s)}onResizeCamera(e){const{width:t,height:s}=e,{main:i}=this.cameras;i.setOrigin(0,.5),this.intro.isComplete?i.setViewport(0,0,t,s):i.setViewport(0,0,Ne.CONFIG.INTRO.CAMERA.WIDTH,s)}onResizeGameObjects(e){this.ui.resize(e),this.ground.resize(e)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(Ne,"CONFIG",a.SCENES.GAME);const Ae=Ne;class pe extends n().Scene{constructor(){super(pe.CONFIG.NAME)}preload(){this.load.atlas("dino","assets/sprites/dino-atlas.png","assets/sprites/dino-atlas.json"),this.load.bitmapFont("joystix","assets/fonts/joystix_monospace.png","assets/fonts/joystix_monospace.fnt"),this.load.audio("player-action","assets/sounds/player-action.mp3"),this.load.audio("achievement","assets/sounds/achievement.mp3"),this.load.audio("gameover","assets/sounds/gameover.mp3")}create(){this.scene.start(Ae.CONFIG.NAME)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(pe,"CONFIG",a.SCENES.BOOT);const Te=pe;class me extends n().Game{constructor(e){super(e),this.registerResizeHandler(),this.addScenes(),this.startScene()}registerResizeHandler(){this.scale.on("resize",()=>{const{parentSize:e}=this.scale,{width:t,height:s}=e;t===this.prevParentWidth&&s===this.prevParentHeight||(this.prevParentWidth=t,this.prevParentHeight=s,this.resize(e))})}addScenes(){this.scene.add(Te.CONFIG.NAME,Te),this.scene.add(Ae.CONFIG.NAME,Ae)}startScene(){this.scene.start(Te.CONFIG.NAME)}resize(e){const{width:t,height:s}=e,i=t<s?me.CONFIG.WIDTH.PORTRAIT:me.CONFIG.WIDTH.LANDSCAPE,n=me.CONFIG.HEIGHT;this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(n*(t/i),"px"),this.scale.resize(i,n)}}!function(e,t,s){t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s}(me,"CONFIG",a.GAME);const ge=me,{NODE_ENV:Ge}="MISSING_ENV_VAR",Ce="production"===Ge,Re={title:"Dino",url:"https://github.com/Autapomorph/dino",version:"1.2.1",type:n().AUTO,backgroundColor:"#fff",banner:!Ce,render:{antialias:!1},scale:{width:1200,height:350,mode:n().Scale.ScaleModes.NONE},physics:{default:"arcade",arcade:{gravity:{y:0},debug:!Ce}}};s(173),function(){var e={},t="";try{t=location.hash.toString()}catch(e){}var s=function(e){var t={};if(!(e=e.replace(/^#/,"")).length)return t;if(e.indexOf("=")<0&&e.indexOf("?")<0)return t._path=n(e),t;var s=e.indexOf("?");if(s>=0){var i=e.substr(0,s);t._path=n(i),e=e.substr(s+1)}var a,r,o,h,c=e.split("&");for(a=0;a<c.length;a++)o=n((r=c[a].split("="))[0]),h=null==r[1]?null:n(r[1]),t[o]=h;return t}(t),i=!1;try{i=null!=window.parent&&window!=window.parent}catch(e){}function n(e){try{return decodeURIComponent(e)}catch(t){return e}}function a(e,t,s){if(t||(t=function(){}),void 0===s&&(s=""),void 0!==window.TelegramWebviewProxy)TelegramWebviewProxy.postEvent(e,JSON.stringify(s)),t();else if(window.external&&"notify"in window.external)window.external.notify(JSON.stringify({eventType:e,eventData:s})),t();else if(i)try{window.parent.postMessage(JSON.stringify({eventType:e,eventData:s}),"*")}catch(e){t(e)}else t({notAvailable:!0})}function r(t,s){var i=e[t];if(void 0!==i&&i.length)for(var n=0;n<i.length;n++)try{i[n](t,s)}catch(e){}}window.TelegramGameProxy_receiveEvent=r,window.TelegramGameProxy={initParams:s,receiveEvent:r,onEvent:function(t,s){void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(s)&&e[t].push(s)},shareScore:function(){a("share_score",function(e){if(e){var t=s.tgShareScoreUrl;t&&function(e){if(!e.match(/^(web\+)?tgb?:\/\/./))return!1;if(navigator.userAgent.match(/iOS|iPhone OS|iPhone|iPod|iPad/i)){var t=document.getElementById("tgme_frame_cont")||document.body,s=document.createElement("iframe");t.appendChild(s);var i=!1,n=function(){i=!0};window.addEventListener("pagehide",n,!1),window.addEventListener("blur",n,!1),null!==s&&(s.src=e),setTimeout(function(){i||(window.location=e),window.removeEventListener("pagehide",n,!1),window.removeEventListener("blur",n,!1)},2e3)}else window.location=e}(t)}})},paymentFormSubmit:function(e){if(!(e&&e.credentials&&"card"===e.credentials.type&&e.credentials.token&&e.credentials.token.match(/^[A-Za-z0-9\/=_\-]{4,512}$/)&&e.title))throw console.error("[TgProxy] Invalid form data submitted",e),Error("PaymentFormDataInvalid");a("payment_form_submit",!1,e)}}}(),new ge(Re),Ce&&"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.js")})}},e=>{e.O(0,[549],()=>e(e.s=8229)),e.O()}]);