{"version":3,"file":"scenes-D5GcjUem.js","sources":["../../src/scenes/GameScene.ts"],"sourcesContent":["/**\n * ä¸»éŠæˆ²å ´æ™¯ - Vite + Phaser 3 ç‰ˆæœ¬\n * åŸºæ–¼è¨˜æ†¶ç§‘å­¸çš„é£›æ©Ÿç¢°æ’è‹±èªå­¸ç¿’éŠæˆ²\n * æ•´åˆå®Œæ•´çš„éŠæˆ²é‚è¼¯å’Œç®¡ç†å™¨ç³»çµ±\n */\n\nimport Phaser from 'phaser';\nimport { GameConfig, GameState, GEPTWord, ParentMessage } from '../types/game';\nimport { GEPTManager, GEPTLevel } from '../managers/GEPTManager';\nimport { CollisionDetectionSystem, CollisionEvent } from '../managers/CollisionDetectionSystem';\nimport { MemoryEnhancementEngine, LearningEvent } from '../managers/MemoryEnhancementEngine';\n\nexport default class GameScene extends Phaser.Scene {\n  // éŠæˆ²é…ç½®å’Œç‹€æ…‹\n  private gameConfig!: GameConfig;\n  private gameState: GameState = {\n    isPlaying: false,\n    isPaused: false,\n    currentScore: 0,\n    currentHealth: 100,\n    wordsLearned: 0,\n    accuracy: 0\n  };\n\n  // éŠæˆ²ç‰©ä»¶\n  private player!: Phaser.Physics.Arcade.Image;\n  private clouds!: Phaser.Physics.Arcade.Group;\n  private cursors!: Phaser.Types.Input.Keyboard.CursorKeys;\n  private backgroundLayers: Phaser.GameObjects.TileSprite[] = [];\n\n  // UI å…ƒç´ \n  private scoreText!: Phaser.GameObjects.Text;\n  private healthText!: Phaser.GameObjects.Text;\n  private targetWordText!: Phaser.GameObjects.Text;\n  private accuracyText!: Phaser.GameObjects.Text;\n  private wordsLearnedText!: Phaser.GameObjects.Text;\n\n  // ç®¡ç†å™¨ç³»çµ±\n  private geptManager!: GEPTManager;\n  private collisionSystem!: CollisionDetectionSystem;\n  private memoryEngine!: MemoryEnhancementEngine;\n\n  // éŠæˆ²é‚è¼¯\n  private cloudSpawnTimer!: Phaser.Time.TimerEvent;\n  private currentTargetWord?: GEPTWord;\n  private targetWordSetTime: number = 0;\n\n  // éŠæˆ²çµ±è¨ˆ\n  private totalCollisions: number = 0;\n  private correctCollisions: number = 0;\n\n  constructor() {\n    super({ key: 'GameScene' });\n  }\n\n  init() {\n    console.log('ğŸ® åˆå§‹åŒ–éŠæˆ²å ´æ™¯');\n\n    // å¾è¨»å†Šè¡¨ç²å–éŠæˆ²é…ç½®\n    this.gameConfig = this.registry.get('gameConfig') || {\n      geptLevel: 'elementary',\n      enableSound: true,\n      enableHapticFeedback: true,\n      difficulty: 'medium',\n      gameMode: 'practice'\n    };\n\n    console.log('ğŸ“‹ éŠæˆ²é…ç½®:', this.gameConfig);\n\n    // åˆå§‹åŒ–ç®¡ç†å™¨ç³»çµ±\n    this.initializeManagers();\n  }\n\n  /**\n   * åˆå§‹åŒ–ç®¡ç†å™¨ç³»çµ±\n   */\n  private initializeManagers(): void {\n    // åˆå§‹åŒ– GEPT ç®¡ç†å™¨\n    this.geptManager = new GEPTManager();\n    this.geptManager.setLevel(this.gameConfig.geptLevel);\n\n    // åˆå§‹åŒ–è¨˜æ†¶å¢å¼·å¼•æ“\n    this.memoryEngine = new MemoryEnhancementEngine();\n\n    // åˆå§‹åŒ–ç¢°æ’æª¢æ¸¬ç³»çµ±\n    this.collisionSystem = new CollisionDetectionSystem(\n      this,\n      this.gameConfig.geptLevel,\n      {\n        enableParticles: true,\n        enableScreenShake: true,\n        enableSoundEffects: this.gameConfig.enableSound,\n        enableVisualFeedback: true,\n        particleIntensity: 'medium',\n        soundVolume: 0.7\n      }\n    );\n\n    console.log('ğŸ”§ ç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ');\n  }\n\n  preload() {\n    console.log('ğŸ¨ è¼‰å…¥éŠæˆ²è³‡æº');\n\n    // è¼‰å…¥æœˆäº®ä¸»é¡ŒèƒŒæ™¯åœ–ç‰‡\n    this.loadMoonBackground();\n\n    // ä¿®å¾©ç´‹ç†ç”Ÿæˆå•é¡Œ - ä½¿ç”¨æ­£ç¢ºçš„æ–¹æ³•\n    // ç©å®¶é£›æ©Ÿ - è—è‰²ä¸‰è§’å½¢\n    const planeGraphics = this.add.graphics();\n    planeGraphics.fillStyle(0x0066ff);\n    planeGraphics.fillTriangle(16, 0, 0, 32, 32, 32);\n    planeGraphics.generateTexture('player-plane', 32, 32);\n    planeGraphics.destroy();\n\n    // è©å½™é›²æœµ - ç™½è‰²æ©¢åœ“\n    const cloudGraphics = this.add.graphics();\n    cloudGraphics.fillStyle(0xffffff);\n    cloudGraphics.fillEllipse(32, 16, 60, 28);\n    cloudGraphics.lineStyle(2, 0x888888);\n    cloudGraphics.strokeEllipse(32, 16, 60, 28);\n    cloudGraphics.generateTexture('cloud-word', 64, 32);\n    cloudGraphics.destroy();\n\n    // èƒŒæ™¯æ˜Ÿæ˜Ÿ - å°ç™½é»\n    const starGraphics = this.add.graphics();\n    starGraphics.fillStyle(0xffffff);\n    starGraphics.fillCircle(2, 2, 2);\n    starGraphics.generateTexture('star', 4, 4);\n    starGraphics.destroy();\n\n    console.log('âœ… éŠæˆ²è³‡æºè¼‰å…¥å®Œæˆ - åŒ…å«æœˆäº®èƒŒæ™¯');\n  }\n\n  /**\n   * è¼‰å…¥æœˆäº®ä¸»é¡ŒèƒŒæ™¯åœ–ç‰‡\n   */\n  private loadMoonBackground(): void {\n    console.log('ğŸŒ™ è¼‰å…¥æœˆäº®ä¸»é¡ŒèƒŒæ™¯');\n\n    // å˜—è©¦è¼‰å…¥èƒŒæ™¯åœ–ç‰‡ï¼Œå¦‚æœä¸å­˜åœ¨å‰‡ä½¿ç”¨å‚™ç”¨æ–¹æ¡ˆ\n    try {\n      // èƒŒæ™¯å±¤ 1 - æœ€é çš„èƒŒæ™¯ï¼ˆå¤©ç©º/æ˜Ÿç©ºï¼‰\n      this.load.image('moon-bg-1', '/assets/backgrounds/moon/layer-1.png');\n\n      // èƒŒæ™¯å±¤ 2 - ä¸­æ™¯ï¼ˆå±±è„ˆ/åœ°å½¢ï¼‰\n      this.load.image('moon-bg-2', '/assets/backgrounds/moon/layer-2.png');\n\n      // èƒŒæ™¯å±¤ 3 - è¿‘æ™¯ï¼ˆæ¨¹æœ¨/å»ºç¯‰ï¼‰\n      this.load.image('moon-bg-3', '/assets/backgrounds/moon/layer-3.png');\n\n      // æœˆäº®\n      this.load.image('moon', '/assets/backgrounds/moon/moon.png');\n\n      console.log('ğŸŒ™ æœˆäº®èƒŒæ™¯åœ–ç‰‡è¼‰å…¥æ’ç¨‹å®Œæˆ');\n    } catch (error) {\n      console.warn('âš ï¸ æœˆäº®èƒŒæ™¯è¼‰å…¥å¤±æ•—ï¼Œå°‡ä½¿ç”¨å‚™ç”¨èƒŒæ™¯:', error);\n    }\n  }\n\n  create() {\n    console.log('ğŸ—ï¸ å‰µå»ºéŠæˆ²å ´æ™¯');\n\n    // å‰µå»ºè¦–å·®èƒŒæ™¯\n    this.createParallaxBackground();\n\n    // å‰µå»ºç©å®¶é£›æ©Ÿ\n    this.createPlayer();\n\n    // å‰µå»ºé›²æœµç¾¤çµ„\n    this.createClouds();\n\n    // å‰µå»ºå®Œæ•´çš„ UI\n    this.createGameHUD();\n\n    // è¨­ç½®è¼¸å…¥æ§åˆ¶\n    this.setupInput();\n\n    // è¨­ç½®ç‰©ç†ç¢°æ’\n    this.setupPhysics();\n\n    // è¨­ç½®ç›®æ¨™è©å½™\n    this.setRandomTargetWord();\n\n    // é–‹å§‹é›²æœµç”Ÿæˆ\n    this.startCloudSpawning();\n\n    console.log('âœ… éŠæˆ²å ´æ™¯å‰µå»ºå®Œæˆ');\n\n    // è‡ªå‹•é–‹å§‹éŠæˆ²\n    this.startGame();\n  }\n\n  /**\n   * å‰µå»ºæœˆäº®ä¸»é¡Œè¦–å·®èƒŒæ™¯\n   */\n  private createParallaxBackground(): void {\n    console.log('ï¿½ å‰µå»ºæœˆäº®ä¸»é¡Œè¦–å·®èƒŒæ™¯');\n\n    // å‰µå»ºåŸºç¤èƒŒæ™¯è‰²ï¼ˆæ·±å¤œè—è‰²ï¼‰\n    const bgRect = this.add.rectangle(400, 300, 800, 600, 0x0a0a2e);\n    bgRect.setDepth(-20);\n\n    // å˜—è©¦ä½¿ç”¨æœˆäº®ä¸»é¡ŒèƒŒæ™¯ï¼Œå¦‚æœè¼‰å…¥å¤±æ•—å‰‡ä½¿ç”¨å‚™ç”¨æ–¹æ¡ˆ\n    this.createMoonBackgroundLayers();\n\n    // å‰µå»ºæ˜Ÿç©ºèƒŒæ™¯\n    this.createStarField();\n\n    console.log('ğŸŒ™ æœˆäº®ä¸»é¡Œè¦–å·®èƒŒæ™¯å‰µå»ºå®Œæˆ');\n  }\n\n  /**\n   * å‰µå»ºæœˆäº®ä¸»é¡ŒèƒŒæ™¯å±¤\n   */\n  private createMoonBackgroundLayers(): void {\n    const backgroundLayers: Phaser.GameObjects.TileSprite[] = [];\n\n    // æª¢æŸ¥æœˆäº®èƒŒæ™¯åœ–ç‰‡æ˜¯å¦è¼‰å…¥æˆåŠŸ\n    const hasMoonBg1 = this.textures.exists('moon-bg-1');\n    const hasMoonBg2 = this.textures.exists('moon-bg-2');\n    const hasMoonBg3 = this.textures.exists('moon-bg-3');\n    const hasMoon = this.textures.exists('moon');\n\n    if (hasMoonBg1 || hasMoonBg2 || hasMoonBg3) {\n      console.log('ğŸŒ™ ä½¿ç”¨æœˆäº®ä¸»é¡ŒèƒŒæ™¯åœ–ç‰‡');\n\n      // èƒŒæ™¯å±¤ 1 - æœ€é çš„èƒŒæ™¯ï¼ˆå¤©ç©ºï¼‰\n      if (hasMoonBg1) {\n        const layer1 = this.add.tileSprite(0, 0, 800, 600, 'moon-bg-1');\n        layer1.setOrigin(0, 0);\n        layer1.setDepth(-15);\n        backgroundLayers.push(layer1);\n      }\n\n      // æœˆäº®\n      if (hasMoon) {\n        const moon = this.add.image(650, 150, 'moon');\n        moon.setDepth(-14);\n        moon.setScale(0.8);\n        moon.setAlpha(0.9);\n      }\n\n      // èƒŒæ™¯å±¤ 2 - ä¸­æ™¯ï¼ˆå±±è„ˆï¼‰\n      if (hasMoonBg2) {\n        const layer2 = this.add.tileSprite(0, 0, 800, 600, 'moon-bg-2');\n        layer2.setOrigin(0, 0);\n        layer2.setDepth(-13);\n        backgroundLayers.push(layer2);\n      }\n\n      // èƒŒæ™¯å±¤ 3 - è¿‘æ™¯ï¼ˆæ¨¹æœ¨ï¼‰\n      if (hasMoonBg3) {\n        const layer3 = this.add.tileSprite(0, 0, 800, 600, 'moon-bg-3');\n        layer3.setOrigin(0, 0);\n        layer3.setDepth(-12);\n        backgroundLayers.push(layer3);\n      }\n\n    } else {\n      console.log('ğŸŒŒ ä½¿ç”¨å‚™ç”¨æ¼¸å±¤èƒŒæ™¯');\n\n      // å‚™ç”¨æ–¹æ¡ˆï¼šå‰µå»ºæ¼¸å±¤èƒŒæ™¯\n      const layer1 = this.add.graphics();\n      layer1.fillGradientStyle(0x0a0a2e, 0x0a0a2e, 0x1a1a4e, 0x1a1a4e);\n      layer1.fillRect(0, 0, 800, 600);\n      layer1.generateTexture('fallback-bg-1', 800, 600);\n      layer1.destroy();\n\n      const layer2 = this.add.graphics();\n      layer2.fillGradientStyle(0x1a1a4e, 0x1a1a4e, 0x2a2a6e, 0x2a2a6e);\n      layer2.fillRect(0, 0, 800, 600);\n      layer2.generateTexture('fallback-bg-2', 800, 600);\n      layer2.destroy();\n\n      const fallbackLayer1 = this.add.tileSprite(0, 0, 800, 600, 'fallback-bg-1');\n      fallbackLayer1.setOrigin(0, 0);\n      fallbackLayer1.setDepth(-15);\n      fallbackLayer1.setAlpha(0.7);\n      backgroundLayers.push(fallbackLayer1);\n\n      const fallbackLayer2 = this.add.tileSprite(0, 0, 800, 600, 'fallback-bg-2');\n      fallbackLayer2.setOrigin(0, 0);\n      fallbackLayer2.setDepth(-13);\n      fallbackLayer2.setAlpha(0.5);\n      backgroundLayers.push(fallbackLayer2);\n    }\n\n    this.backgroundLayers = backgroundLayers;\n  }\n\n  /**\n   * å‰µå»ºæ˜Ÿç©ºèƒŒæ™¯\n   */\n  private createStarField(): void {\n    console.log('â­ å‰µå»ºæ˜Ÿç©ºèƒŒæ™¯');\n\n    // å‰µå»ºä¸åŒå¤§å°çš„æ˜Ÿæ˜Ÿ\n    for (let i = 0; i < 80; i++) {\n      const x = Phaser.Math.Between(0, 800);\n      const y = Phaser.Math.Between(0, 400); // æ˜Ÿæ˜Ÿä¸»è¦åœ¨ä¸ŠåŠéƒ¨åˆ†\n      const star = this.add.image(x, y, 'star');\n\n      const scale = Phaser.Math.FloatBetween(0.3, 1.2);\n      const alpha = Phaser.Math.FloatBetween(0.4, 1);\n\n      star.setScale(scale);\n      star.setAlpha(alpha);\n      star.setDepth(-11);\n\n      // æ·»åŠ é–ƒçˆæ•ˆæœ\n      this.tweens.add({\n        targets: star,\n        alpha: alpha * 0.3,\n        duration: Phaser.Math.Between(2000, 4000),\n        yoyo: true,\n        repeat: -1,\n        ease: 'Sine.easeInOut'\n      });\n    }\n  }\n\n  /**\n   * å‰µå»ºç©å®¶é£›æ©Ÿ\n   */\n  private createPlayer(): void {\n    console.log('âœˆï¸ å‰µå»ºç©å®¶é£›æ©Ÿ (ä¿®å¾©ç‰ˆæœ¬)');\n\n    this.player = this.physics.add.image(100, 300, 'player-plane');\n    this.player.setCollideWorldBounds(true);\n    this.player.setScale(1.5);\n    this.player.setDepth(10); // ç¢ºä¿åœ¨å‰æ™¯\n    this.player.setAlpha(1); // ç¢ºä¿ä¸é€æ˜\n    this.player.setVisible(true); // ç¢ºä¿å¯è¦‹\n\n    console.log('âœˆï¸ ç©å®¶é£›æ©Ÿå‰µå»ºå®Œæˆ:', {\n      x: this.player.x,\n      y: this.player.y,\n      visible: this.player.visible,\n      alpha: this.player.alpha,\n      depth: this.player.depth,\n      texture: this.player.texture.key\n    });\n  }\n\n  private createClouds() {\n    this.clouds = this.physics.add.group();\n    console.log('â˜ï¸ å‰µå»ºé›²æœµç¾¤çµ„');\n  }\n\n  /**\n   * å‰µå»ºå®Œæ•´çš„éŠæˆ² HUD\n   */\n  private createGameHUD(): void {\n    console.log('ğŸ“Š å‰µå»ºéŠæˆ² HUD (å·²æ“´å±•ç›®æ¨™è©å½™é¡¯ç¤º)');\n\n    // åˆ†æ•¸é¡¯ç¤º\n    this.scoreText = this.add.text(16, 16, 'åˆ†æ•¸: 0', {\n      fontSize: '24px',\n      color: '#ffffff',\n      backgroundColor: '#000000',\n      padding: { x: 8, y: 4 }\n    }).setDepth(100);\n\n    // ç”Ÿå‘½å€¼é¡¯ç¤º\n    this.healthText = this.add.text(16, 50, 'ç”Ÿå‘½å€¼: 100', {\n      fontSize: '20px',\n      color: '#ffffff',\n      backgroundColor: '#000000',\n      padding: { x: 8, y: 4 }\n    }).setDepth(100);\n\n    // æº–ç¢ºç‡é¡¯ç¤º\n    this.accuracyText = this.add.text(16, 84, 'æº–ç¢ºç‡: 0%', {\n      fontSize: '18px',\n      color: '#ffffff',\n      backgroundColor: '#000000',\n      padding: { x: 8, y: 4 }\n    }).setDepth(100);\n\n    // å­¸ç¿’è©å½™æ•¸é¡¯ç¤º\n    this.wordsLearnedText = this.add.text(16, 118, 'å­¸ç¿’è©å½™: 0', {\n      fontSize: '18px',\n      color: '#ffffff',\n      backgroundColor: '#000000',\n      padding: { x: 8, y: 4 }\n    }).setDepth(100);\n\n    // ç›®æ¨™è©å½™é¡¯ç¤º - æ›´å¤§æ›´æ˜é¡¯\n    this.targetWordText = this.add.text(400, 16, 'ç›®æ¨™: è¼‰å…¥ä¸­...', {\n      fontSize: '24px',\n      color: '#ffff00',\n      backgroundColor: '#000000',\n      padding: { x: 12, y: 8 },\n      fontStyle: 'bold'\n    }).setOrigin(0.5, 0).setDepth(100);\n\n    // GEPT ç­‰ç´šé¡¯ç¤º\n    const geptLevelText = this.add.text(400, 50, `GEPT: ${this.gameConfig.geptLevel}`, {\n      fontSize: '16px',\n      color: '#00ff00',\n      backgroundColor: '#000000',\n      padding: { x: 8, y: 4 }\n    }).setOrigin(0.5, 0).setDepth(100);\n  }\n\n  private setupInput() {\n    this.cursors = this.input.keyboard!.createCursorKeys();\n    \n    // WASD æ§åˆ¶\n    const wasd = this.input.keyboard!.addKeys('W,S,A,D');\n    (this as any).wasd = wasd;\n    \n    console.log('ğŸ® è¨­ç½®è¼¸å…¥æ§åˆ¶');\n  }\n\n  /**\n   * è¨­ç½®ç‰©ç†ç¢°æ’ç³»çµ±\n   */\n  private setupPhysics(): void {\n    console.log('âš¡ è¨­ç½®ç‰©ç†ç¢°æ’ (å·²ç§»é™¤å­å½ˆç¢°æ’ï¼Œä¿®æ”¹ç©å®¶ç¢°æ’)');\n\n    // ç©å®¶èˆ‡é›²æœµç¢°æ’ - ä½¿ç”¨å®Œæ•´çš„ç¢°æ’æª¢æ¸¬ç³»çµ±\n    this.physics.add.overlap(\n      this.player,\n      this.clouds,\n      this.handleAdvancedCollision,\n      undefined,\n      this\n    );\n  }\n\n  /**\n   * è¨­ç½®éš¨æ©Ÿç›®æ¨™è©å½™\n   */\n  private setRandomTargetWord(): void {\n    // å¾ GEPT ç®¡ç†å™¨ç²å–è©å½™\n    const randomWord = this.geptManager.getRandomWord();\n    this.currentTargetWord = randomWord || undefined;\n    this.gameState.currentTargetWord = this.currentTargetWord;\n    this.targetWordSetTime = Date.now();\n\n    if (this.targetWordText && this.currentTargetWord) {\n      this.targetWordText.setText(`ç›®æ¨™: ${this.currentTargetWord.chinese} (${this.currentTargetWord.english})`);\n\n      // æ›´æ–°ç¢°æ’æª¢æ¸¬ç³»çµ±çš„ç›®æ¨™è©å½™\n      this.collisionSystem.setTargetWord(\n        this.currentTargetWord.english,\n        this.currentTargetWord.chinese\n      );\n\n      console.log('ğŸ¯ è¨­ç½®ç›®æ¨™è©å½™:', this.currentTargetWord.english);\n    }\n  }\n\n  private startCloudSpawning() {\n    this.cloudSpawnTimer = this.time.addEvent({\n      delay: 2000,\n      callback: this.spawnCloud,\n      callbackScope: this,\n      loop: true\n    });\n    console.log('â˜ï¸ é–‹å§‹é›²æœµç”Ÿæˆ');\n  }\n\n  /**\n   * ç”Ÿæˆè©å½™é›²æœµ (ä¿®å¾©ç‰ˆæœ¬)\n   */\n  private spawnCloud(): void {\n    if (!this.gameState.isPlaying) return;\n\n    // å¾ GEPT ç®¡ç†å™¨ç²å–éš¨æ©Ÿè©å½™\n    const word = this.geptManager.getRandomWord();\n    if (!word) return;\n\n    const x = 850;\n    const y = Phaser.Math.Between(100, 500);\n\n    const cloud = this.physics.add.image(x, y, 'cloud-word');\n    cloud.setVelocityX(-100);\n    cloud.setData('word', word);\n    cloud.setData('isTarget', word.english === this.currentTargetWord?.english);\n    cloud.setDepth(5); // ç¢ºä¿åœ¨å‰æ™¯\n    cloud.setAlpha(1); // ç¢ºä¿ä¸é€æ˜\n    cloud.setVisible(true); // ç¢ºä¿å¯è¦‹\n\n    // æ·»åŠ è©å½™æ–‡å­—\n    const isTarget = word.english === this.currentTargetWord?.english;\n    const wordText = this.add.text(x, y, word.english, {\n      fontSize: '16px',\n      color: isTarget ? '#ff0000' : '#000000',\n      fontStyle: isTarget ? 'bold' : 'normal',\n      backgroundColor: isTarget ? '#ffff00' : '#ffffff',\n      padding: { x: 4, y: 2 }\n    }).setOrigin(0.5);\n\n    wordText.setDepth(6); // æ–‡å­—åœ¨é›²æœµä¹‹ä¸Š\n    wordText.setAlpha(1);\n    wordText.setVisible(true);\n\n    // å°‡æ–‡å­—ç¶å®šåˆ°é›²æœµ\n    cloud.setData('wordText', wordText);\n\n    this.clouds.add(cloud);\n\n    console.log('â˜ï¸ ç”Ÿæˆé›²æœµ (ä¿®å¾©ç‰ˆæœ¬):', word.english, isTarget ? '(ç›®æ¨™)' : '', {\n      cloudVisible: cloud.visible,\n      textVisible: wordText.visible,\n      cloudDepth: cloud.depth,\n      textDepth: wordText.depth\n    });\n  }\n\n  /**\n   * è™•ç†é«˜ç´šç¢°æ’æª¢æ¸¬\n   */\n  private handleAdvancedCollision(player: any, cloud: any): void {\n    const word: GEPTWord = cloud.getData('word');\n    const isTarget: boolean = cloud.getData('isTarget');\n    const wordText = cloud.getData('wordText');\n\n    // ä½¿ç”¨ç¢°æ’æª¢æ¸¬ç³»çµ±è™•ç†ç¢°æ’\n    const collisionEvent = this.collisionSystem.handleCollision(player, cloud, word);\n\n    // è¨˜éŒ„å­¸ç¿’äº‹ä»¶åˆ°è¨˜æ†¶å¢å¼·å¼•æ“\n    const learningEvent: LearningEvent = {\n      wordId: word.id,\n      word: word.english,\n      timestamp: Date.now(),\n      responseTime: Date.now() - this.targetWordSetTime,\n      isCorrect: collisionEvent.type === 'correct',\n      attemptNumber: this.totalCollisions + 1,\n      contextData: {\n        targetWord: this.currentTargetWord?.english,\n        geptLevel: this.gameConfig.geptLevel,\n        gameMode: this.gameConfig.gameMode\n      }\n    };\n\n    this.memoryEngine.recordLearningEvent(learningEvent);\n\n    // æ›´æ–°çµ±è¨ˆ\n    this.totalCollisions++;\n    if (collisionEvent.type === 'correct') {\n      this.correctCollisions++;\n      this.gameState.currentScore += 10;\n      this.gameState.wordsLearned++;\n\n      // è¨­ç½®æ–°çš„ç›®æ¨™è©å½™\n      this.setRandomTargetWord();\n\n      console.log('âœ… æ­£ç¢ºç¢°æ’:', word.english);\n    } else {\n      this.gameState.currentHealth -= 20;\n      console.log('âŒ éŒ¯èª¤ç¢°æ’:', word.english);\n\n      if (this.gameState.currentHealth <= 0) {\n        this.endGame();\n        return;\n      }\n    }\n\n    // ç§»é™¤é›²æœµå’Œæ–‡å­—\n    if (wordText) wordText.destroy();\n    cloud.destroy();\n\n    // æ›´æ–° UI å’Œçµ±è¨ˆ\n    this.updateGameStats();\n    this.updateUI();\n\n    // å‘çˆ¶é é¢ç™¼é€æ›´æ–°\n    this.sendMessageToParent({\n      type: 'GAME_SCORE_UPDATE',\n      score: this.gameState.currentScore,\n      health: this.gameState.currentHealth\n    });\n  }\n\n  /**\n   * æ›´æ–°éŠæˆ²çµ±è¨ˆ\n   */\n  private updateGameStats(): void {\n    // è¨ˆç®—æº–ç¢ºç‡\n    this.gameState.accuracy = this.totalCollisions > 0\n      ? Math.round((this.correctCollisions / this.totalCollisions) * 100)\n      : 0;\n  }\n\n  /**\n   * æ›´æ–° UI é¡¯ç¤º\n   */\n  private updateUI(): void {\n    this.scoreText.setText(`åˆ†æ•¸: ${this.gameState.currentScore}`);\n    this.healthText.setText(`ç”Ÿå‘½å€¼: ${this.gameState.currentHealth}`);\n    this.accuracyText.setText(`æº–ç¢ºç‡: ${this.gameState.accuracy}%`);\n    this.wordsLearnedText.setText(`å­¸ç¿’è©å½™: ${this.gameState.wordsLearned}`);\n\n    console.log('ğŸ“Š æ›´æ–° HUD:', {\n      åˆ†æ•¸: this.gameState.currentScore,\n      ç”Ÿå‘½å€¼: this.gameState.currentHealth,\n      æº–ç¢ºç‡: this.gameState.accuracy,\n      å­¸ç¿’è©å½™: this.gameState.wordsLearned\n    });\n  }\n\n  private startGame() {\n    this.gameState.isPlaying = true;\n    this.gameState.isPaused = false;\n    console.log('ğŸš€ éŠæˆ²é–‹å§‹');\n    \n    this.sendMessageToParent({\n      type: 'GAME_STATE_CHANGE',\n      state: 'playing'\n    });\n  }\n\n  private endGame() {\n    this.gameState.isPlaying = false;\n    console.log('ğŸ éŠæˆ²çµæŸ');\n    \n    // åœæ­¢é›²æœµç”Ÿæˆ\n    if (this.cloudSpawnTimer) {\n      this.cloudSpawnTimer.destroy();\n    }\n    \n    // æ¸…é™¤æ‰€æœ‰é›²æœµ\n    this.clouds.clear(true, true);\n    \n    this.sendMessageToParent({\n      type: 'GAME_COMPLETE',\n      score: this.gameState.currentScore,\n      health: this.gameState.currentHealth\n    });\n  }\n\n  private sendMessageToParent(message: ParentMessage) {\n    if (window.parent !== window) {\n      window.parent.postMessage(message, '*');\n    }\n  }\n\n  update(_time: number, _delta: number): void {\n    if (!this.gameState.isPlaying || this.gameState.isPaused) return;\n\n    // æ›´æ–°è¦–å·®èƒŒæ™¯\n    this.updateParallaxBackground();\n\n    // ç©å®¶ç§»å‹•æ§åˆ¶\n    this.handlePlayerMovement();\n\n    // æ¸…ç†è¶…å‡ºé‚Šç•Œçš„ç‰©ä»¶\n    this.cleanupObjects();\n  }\n\n  /**\n   * æ›´æ–°æœˆäº®ä¸»é¡Œè¦–å·®èƒŒæ™¯\n   */\n  private updateParallaxBackground(): void {\n    // ç§»å‹•èƒŒæ™¯å±¤å‰µé€ è¦–å·®æ•ˆæœ\n    this.backgroundLayers.forEach((layer, index) => {\n      // ä¸åŒå±¤æœ‰ä¸åŒçš„ç§»å‹•é€Ÿåº¦ï¼Œå‰µé€ æ·±åº¦æ„Ÿ\n      const speed = (index + 1) * 0.3; // æ¸›æ…¢é€Ÿåº¦è®“æ•ˆæœæ›´è‡ªç„¶\n      layer.tilePositionX += speed;\n    });\n\n    // æ¯éš”ä¸€æ®µæ™‚é–“è¼¸å‡ºæ—¥èªŒï¼ˆæ¸›å°‘é »ç‡ï¼‰\n    if (Math.floor(Date.now() / 1000) % 10 === 0) {\n      console.log('ï¿½ æ›´æ–°æœˆäº®ä¸»é¡Œè¦–å·®èƒŒæ™¯');\n    }\n  }\n\n  /**\n   * è™•ç†ç©å®¶ç§»å‹•\n   */\n  private handlePlayerMovement(): void {\n    const speed = 250;\n    const wasd = (this as any).wasd;\n\n    if (this.cursors.left.isDown || wasd?.A.isDown) {\n      this.player.setVelocityX(-speed);\n    } else if (this.cursors.right.isDown || wasd?.D.isDown) {\n      this.player.setVelocityX(speed);\n    } else {\n      this.player.setVelocityX(0);\n    }\n\n    if (this.cursors.up.isDown || wasd?.W.isDown) {\n      this.player.setVelocityY(-speed);\n    } else if (this.cursors.down.isDown || wasd?.S.isDown) {\n      this.player.setVelocityY(speed);\n    } else {\n      this.player.setVelocityY(0);\n    }\n  }\n\n  /**\n   * æ¸…ç†è¶…å‡ºé‚Šç•Œçš„ç‰©ä»¶\n   */\n  private cleanupObjects(): void {\n    this.clouds.children.entries.forEach((cloud: any) => {\n      if (cloud.x < -100) {\n        const wordText = cloud.getData('wordText');\n        if (wordText) wordText.destroy();\n        cloud.destroy();\n      } else {\n        // æ›´æ–°æ–‡å­—ä½ç½®\n        const wordText = cloud.getData('wordText');\n        if (wordText) {\n          wordText.setPosition(cloud.x, cloud.y);\n        }\n      }\n    });\n  }\n}\n"],"names":["GameScene","Phaser","Scene","constructor","super","key","__publicField","this","isPlaying","isPaused","currentScore","currentHealth","wordsLearned","accuracy","init","console","log","gameConfig","registry","get","geptLevel","enableSound","enableHapticFeedback","difficulty","gameMode","initializeManagers","geptManager","GEPTManager","setLevel","memoryEngine","MemoryEnhancementEngine","collisionSystem","CollisionDetectionSystem","enableParticles","enableScreenShake","enableSoundEffects","enableVisualFeedback","particleIntensity","soundVolume","preload","loadMoonBackground","planeGraphics","add","graphics","fillStyle","fillTriangle","generateTexture","destroy","cloudGraphics","fillEllipse","lineStyle","strokeEllipse","starGraphics","fillCircle","load","image","error","warn","create","createParallaxBackground","createPlayer","createClouds","createGameHUD","setupInput","setupPhysics","setRandomTargetWord","startCloudSpawning","startGame","rectangle","setDepth","createMoonBackgroundLayers","createStarField","backgroundLayers","hasMoonBg1","textures","exists","hasMoonBg2","hasMoonBg3","hasMoon","layer1","tileSprite","setOrigin","push","moon","setScale","setAlpha","layer2","layer3","fillGradientStyle","fillRect","fallbackLayer1","fallbackLayer2","i","x","Math","Between","y","star","scale","FloatBetween","alpha","tweens","targets","duration","yoyo","repeat","ease","player","physics","setCollideWorldBounds","setVisible","visible","depth","texture","clouds","group","scoreText","text","fontSize","color","backgroundColor","padding","healthText","accuracyText","wordsLearnedText","targetWordText","fontStyle","cursors","input","keyboard","createCursorKeys","wasd","addKeys","overlap","handleAdvancedCollision","randomWord","getRandomWord","currentTargetWord","gameState","targetWordSetTime","Date","now","setText","chinese","english","setTargetWord","cloudSpawnTimer","time","addEvent","delay","callback","spawnCloud","callbackScope","loop","word","cloud","setVelocityX","setData","isTarget","wordText","cloudVisible","textVisible","cloudDepth","textDepth","getData","collisionEvent","handleCollision","learningEvent","wordId","id","timestamp","responseTime","isCorrect","type","attemptNumber","totalCollisions","contextData","targetWord","recordLearningEvent","correctCollisions","endGame","updateGameStats","updateUI","sendMessageToParent","score","health","round","state","clear","message","window","parent","postMessage","update","_time","_delta","updateParallaxBackground","handlePlayerMovement","cleanupObjects","forEach","layer","index","speed","tilePositionX","floor","left","isDown","A","right","D","up","W","setVelocityY","down","S","children","entries","setPosition"],"mappings":"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"}