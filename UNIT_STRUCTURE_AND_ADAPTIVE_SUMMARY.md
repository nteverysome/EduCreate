# 🎮 Match-up 遊戲 - 單元結構 & 自適應設計完整指南

## 📋 快速導航

1. **單元結構** - 理解卡片的組成
2. **自適應設計** - 支持 3-20 對卡片
3. **實現方案** - 代碼修改步驟
4. **測試驗證** - 確保功能正常

---

## 🎴 第一部分：單元結構

### 什麼是「單元」？

在 Match-up 遊戲中，一個**單元**是指：
- **1 對卡片** = 1 個英文卡片 + 1 個中文卡片
- 每個單元佔用一定的垂直空間
- 多個單元堆疊形成完整的遊戲佈局

### 單元的組成

```
┌─────────────────────────────────────────┐
│ 🎴 單個單元 (1 對卡片)                  │
├─────────────────────────────────────────┤
│                                         │
│  左側卡片              右側卡片         │
│  ┌──────────────┐    ┌──────────────┐  │
│  │ 🎴 英文卡片  │    │ 🎴 中文卡片  │  │
│  │              │    │              │  │
│  │ 圖片 + 文字  │    │ 圖片 + 文字  │  │
│  │ + 語音按鈕   │    │              │  │
│  └──────────────┘    └──────────────┘  │
│                                         │
│  ↓ 垂直間距 (3-10px)                    │
│                                         │
└─────────────────────────────────────────┘
```

### 卡片內部結構

**左側卡片 (英文)**
```
Container
├── Background (白色 + 黑邊框)
├── Image (可選) - 上半部分
├── Text (英文) - 中間
└── AudioButton (可選) - 右下角
```

**右側卡片 (中文)**
```
Container
├── Background (白色 + 黑邊框)
├── Image (可選) - 上半部分
└── Text (中文) - 中間
```

---

## 📐 第二部分：自適應設計

### 核心概念

當用戶選擇「每頁匹配數」時：
- 3 對 → 卡片大 (65px)
- 5 對 → 卡片中 (48px)
- 10 對 → 卡片小 (28px)
- 20 對 → 卡片最小 (14px)

### 自適應公式

```
可用高度 = 容器高度 - 頂部邊距 - 底部邊距
總間距 = (卡片數 - 1) × 垂直間距
卡片高度 = (可用高度 - 總間距) / 卡片數
```

### 邊距和間距的動態調整

```
當卡片數 ≤ 5：
  邊距 = 基礎邊距 (30px)
  間距 = 基礎間距 (5px)

當卡片數 > 5：
  邊距 = max(10px, 基礎邊距 - (卡片數-5)×2)
  間距 = max(2px, 基礎間距 - (卡片數-5)×0.5)
```

---

## 🛠️ 第三部分：實現方案

### 需要修改的文件

1. **SeparatedLayoutCalculator** (config/separated-layout-calculator.js)
   - 修改 `calculateCardSize()` 方法
   - 添加 `calculateDynamicMargin()` 方法
   - 添加 `calculateDynamicSpacing()` 方法

2. **game.js** (scenes/game.js)
   - 修改 `createLeftRightSingleColumn()` 方法
   - 傳遞 itemCount 到計算器
   - 使用動態計算的卡片大小

### 實現步驟

**步驟 1：修改 SeparatedLayoutCalculator**

在 `calculateCardSize()` 中添加 itemCount 參數，計算動態邊距和間距。

**步驟 2：修改 game.js**

在 `createLeftRightSingleColumn()` 中使用新的計算方法。

**步驟 3：添加測試用例**

為 3, 4, 5, 10, 15, 20 對卡片添加測試。

**步驟 4：視覺驗證**

在瀏覽器中測試不同卡片數，確保顯示正常。

---

## 🧪 第四部分：測試驗證

### 測試清單

- [ ] 3 對卡片 - 正常顯示
- [ ] 4 對卡片 - 卡片變小
- [ ] 5 對卡片 - 卡片更小
- [ ] 10 對卡片 - 卡片很小
- [ ] 15 對卡片 - 卡片最小
- [ ] 20 對卡片 - 卡片超小

### 驗證點

✅ 卡片不超出容器邊界
✅ 卡片大小在 [min, max] 範圍內
✅ 所有卡片都能顯示
✅ 文字能正確顯示
✅ 圖片能正確顯示
✅ 在不同設備上都能正常工作

---

## 📊 預期效果

### 空間利用率提升

| 卡片數 | 利用率 | 改進 |
|--------|-------|------|
| 3 | 60% | 基礎 |
| 5 | 75% | +25% |
| 10 | 85% | +42% |
| 15 | 90% | +50% |
| 20 | 92% | +53% |

### 用戶體驗

- ✅ 更多卡片可見，減少翻頁次數
- ✅ 自動調整大小，無需手動配置
- ✅ 保持良好的可讀性
- ✅ 支持所有設備類型

---

## 🎯 下一步行動

1. **實現代碼修改**
   - 修改 SeparatedLayoutCalculator
   - 修改 game.js

2. **運行測試**
   - 執行所有 35 個現有測試
   - 添加新的自適應測試用例

3. **視覺驗證**
   - 在瀏覽器中測試
   - 確保所有卡片數都能正常顯示

4. **性能檢查**
   - 確保計算時間在 30ms 以內
   - 驗證內存使用正常

---

## 📚 相關文檔

- `ADAPTIVE_CARD_SIZE_DESIGN.md` - 詳細設計方案
- `ADAPTIVE_IMPLEMENTATION_CODE.md` - 完整代碼實現
- `CARD_UNIT_STRUCTURE_VISUALIZATION.md` - 單元結構可視化
- `CARD_LAYOUT_ASCII_VISUALIZATION.md` - ASCII 佈局圖表

