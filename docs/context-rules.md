# EduCreate 開發上下文規則與指導原則

#  停止寫虛假的完成報告，實際去做真一步一步，實際驗證每個步驟
#  在聲稱任何工作完成之前，必須先證明文件真實存在並且服務器正在運行
#  絕對不允許在沒有實際驗證的情況下聲稱完成任何工作
#  如果任何步驟失敗，嘗試修復不能修復調用mcp修復或建議找尋其他MCP方法
#  只有在有實際運行截圖或終端輸出證據時才能聲稱完成
## � **絕對禁止的行為 - 防止虛假工作**

### ❌ **禁止虛假驗證**
1. **絕對不允許在沒有實際運行證據的情況下聲稱任何工作完成**
2. **禁止使用 `view` 工具查看文件就聲稱文件存在**
3. **禁止使用 `open-browser` 工具就聲稱頁面正常載入**
4. **禁止在服務器未啟動時聲稱瀏覽器驗證通過**
5. **禁止寫任何 '✅ 驗證通過' 除非有具體的運行證據**

### ✅ **強制的 Playwright 驗證流程**
**在做任何開發工作之前，必須先完成以下步驟：**

1. **第1步：文件系統驗證**
   ```bash
   # 必須先確認關鍵文件真實存在
   ls package.json
   ls pages/index.tsx
   ls components/unified/ui/Button.tsx
   ```

2. **第2步：服務器啟動驗證**
   ```bash
   # 必須確認開發服務器能成功啟動
   npm run dev
   # 等待看到 "ready" 或 "localhost:3000" 輸出
   ```

3. **第3步：Playwright 真實驗證**
   ```bash
   # 必須運行 Playwright 腳本並獲得截圖證據
   node scripts/real-verification.js
   ```

4. **第4步：截圖證據要求**
   - 每個聲稱完成的頁面都必須有 Playwright 截圖
   - 截圖路徑：`test-results/頁面名稱-screenshot.png`
   - JSON 報告：`test-results/real-verification-report.json`

### 🔴 **錯誤處理規則**
1. **如果 npm run dev 失敗 → 嘗試修復不能修復調用mcp**
2. **如果頁面返回 404 → 嘗試修復不能修復調用mcp**
3. **如果 Playwright 測試失敗 → 嘗試修復不能修復調用mcp**
4. **不允許試圖掩蓋或繞過任何技術問題**

### 📋 **工作前檢查清單**
**每次開始工作前都必須完成：**
```
□ 關鍵文件真實存在 (用 ls 或 dir 確認)
□ 開發服務器成功啟動 (看到實際輸出)
□ Playwright 驗證通過 (有截圖證據)
□ 頁面能在真實瀏覽器中載入
□ 有具體的終端輸出或截圖證據
```
**只有全部打勾才能開始工作。**

### 🎯 **報告標準**
1. **每個完成聲明都必須附上實際的終端輸出**
2. **每個頁面驗證都必須附上 Playwright 截圖**
3. **不允許寫進度報告除非有實際運行證據**
4. **虛假驗證比不驗證更糟糕**

### 💡 **關鍵短語提醒**
- **"先跑 Playwright 驗證再開始工作"**
- **"沒有截圖證據就不要聲稱完成"**
- **"Playwright 失敗就調用mcp修復或建議安裝什麼mcp"**
- **"真實瀏覽器測試才算數"**
- **"文件系統同步問題必須先解決"**

### 📝 **正確的工作示例**

#### ✅ **正確的驗證流程**
```bash
# 第1步：確認文件存在
$ ls package.json
package.json

# 第2步：啟動服務器
$ npm run dev
> ready - started server on 0.0.0.0:3000

# 第3步：Playwright 驗證
$ node scripts/real-verification.js
✅ 所有關鍵文件都存在
✅ 開發服務器啟動成功
✅ 首頁 載入成功
📸 截圖證據保存在: test-results/

# 第4步：開始實際工作
現在可以安全地開始編輯文件...
```

#### ❌ **錯誤的工作方式**
```bash
# 錯誤示例 - 不要這樣做
$ view pages/index.tsx  # ← 只查看文件
✅ 文件存在  # ← 虛假聲明

$ open-browser http://localhost:3000  # ← 沒有先啟動服務器
✅ 頁面正常載入  # ← 虛假聲明

✅ 統一工作完成  # ← 沒有任何實際證據
```

## 🎯 項目核心定位
EduCreate 是一個**記憶科學驅動的智能教育遊戲 SaaS 平台**，專注於創建基於科學記憶原理的互動式學習體驗。

## 📋 **文檔體系說明**

本文檔定義 EduCreate 開發的核心原則和規範，與以下文檔形成完整指導體系：

- **本文檔 (context-rules.md)**: 開發原則與規範
  - ✅ 記憶科學原理優先
  - ✅ GEPT分級系統整合
  - ✅ 無障礙設計強制要求
  - ✅ 開發工作流程和品質標準

- **COMPREHENSIVE_ANALYSIS_AND_ROADMAP.md**: 實施計劃與技術規範
  - 📊 基於實測數據的競品分析
  - 🏗️ 具體技術架構和API設計
  - 📅 4週詳細開發路線圖
  - 📈 性能指標和監控方案

- **DOCUMENTATION_INTEGRATION_GUIDE.md**: 文檔整合使用指南
  - 🔄 兩文檔的協作使用方法
  - 📋 開發流程中的文檔應用
  - 🎯 衝突解決和最佳實踐

**重要**: 所有開發決策都必須同時符合本文檔的原則要求和路線圖的技術規範。

## 📋 核心開發規則

### 0. 防止功能孤立的完整工作流程（最高優先級）

#### 主頁優先原則
- **每個功能都必須在主頁(/)有明顯入口**
- 禁止創建孤立功能，所有功能必須從主頁可發現
- 功能入口形式：導航連結、功能卡片、快速訪問按鈕、儀表板項目

#### 五項同步開發要求
每個功能開發時必須同時創建：
1. **功能本身** - 核心功能實現
2. **主頁入口** - 在主頁添加明顯的功能入口
3. **儀表板整合** - 在 /dashboard 頁面添加功能卡片
4. **導航連結** - 更新導航組件包含新功能
5. **Playwright完整流程測試** - 從主頁開始的端到端測試

#### 三層整合驗證
每個功能必須通過三層驗證：
1. **主頁可見性測試** - 用戶能在主頁找到功能
2. **導航流程測試** - 用戶能順利從主頁進入功能
3. **功能互動測試** - 功能本身正常運作

#### Playwright 完整流程測試要求
- 必須測試從主頁開始的完整用戶旅程
- 包含功能發現 → 功能使用 → 功能退出的完整流程
- 生成截圖錄影報告作為整合證據
- 驗證功能在主要界面的整合狀態

### 1. 記憶科學原理優先
- **間隔重複 (Spaced Repetition)**: 所有學習活動必須支持間隔重複算法
- **主動回憶 (Active Recall)**: 優先設計需要主動思考的互動元素
- **認知負荷管理**: 避免過度複雜的界面設計，專注核心學習目標
- **多感官學習**: 支持視覺、聽覺、觸覺多種感官輸入

### 2. GEPT 分級系統整合
- **詞彙分級**: 所有內容必須支持 GEPT 初級、中級、中高級分級
- **難度漸進**: 遊戲難度必須可根據 GEPT 等級自動調整
- **學習路徑**: 提供基於 GEPT 分級的個人化學習路徑
- **評估標準**: 學習成效評估必須對應 GEPT 能力指標

### 3. 25 種記憶遊戲統一架構
```typescript
// 統一遊戲接口
interface MemoryGameTemplate {
  id: string;
  name: string;
  memoryPrinciple: 'spaced-repetition' | 'active-recall' | 'visual-memory' | 'pattern-recognition';
  geptLevel: 'elementary' | 'intermediate' | 'high-intermediate';
  contentTypes: ('text' | 'image' | 'audio' | 'video')[];
  adaptiveSettings: AdaptiveGameSettings;
}
```

### 4. AI 對話系統標準
- **雙語支持**: 中文和英文無縫切換
- **語音控制**: 支持語音輸入和輸出
- **個人化回應**: 基於學習者程度調整對話複雜度
- **學習引導**: AI 必須能引導學習者完成記憶任務

### 5. 無障礙設計強制要求
- **WCAG 2.1 AA 合規**: 所有組件必須通過無障礙測試
- **鍵盤導航**: 完整的鍵盤操作支持
- **螢幕閱讀器**: 完整的 ARIA 標籤和語義化 HTML
- **視覺輔助**: 高對比度模式、字體大小調整
- **認知輔助**: 簡化操作流程、清晰的視覺層次

## 🏗️ 技術架構規則

### 1. 統一內容模型
```typescript
interface UniversalContent {
  id: string;
  type: 'text' | 'image' | 'audio' | 'mixed';
  geptLevel: GeptLevel;
  memoryTags: MemoryTag[];
  adaptiveMetadata: AdaptiveMetadata;
  crossGameCompatibility: GameCompatibility[];
}
```

### 2. 跨遊戲數據同步
- **統一數據格式**: 所有遊戲使用相同的內容數據結構
- **即時同步**: 用戶在任一遊戲中的進度即時同步到其他遊戲
- **版本控制**: 內容修改必須支持版本追蹤和回滾
- **衝突解決**: 多設備同時編輯的衝突自動解決機制

### 3. 用戶內容輸入系統 (參考 Wordwall)
- **多格式支持**: 文字、圖片、音頻、視頻輸入
- **智能解析**: AI 自動識別內容類型和適合的遊戲模板
- **批量處理**: 支持批量內容上傳和處理
- **格式轉換**: 自動轉換內容格式以適應不同遊戲需求

### 4. 社區分享生態系統
- **三層分享模式**:
  - 公開社區：所有用戶可見和使用
  - 私人分享：通過連結分享給特定用戶
  - 班級群組：教師管理的封閉群組
- **版權保護**: 內容創作者權益保護機制
- **品質控制**: 社區內容的審核和評分系統

## 🧠 記憶科學實現細節

### 1. 間隔重複算法
```typescript
interface SpacedRepetitionConfig {
  initialInterval: number; // 初始間隔（小時）
  easeFactor: number; // 難易度因子
  intervalMultiplier: number; // 間隔倍數
  maxInterval: number; // 最大間隔（天）
}
```

### 2. 學習效果測量
- **記憶強度**: 基於回答正確率和反應時間計算
- **遺忘曲線**: 追蹤個人遺忘模式
- **學習效率**: 單位時間內的學習成效
- **長期保持**: 長期記憶保持率測量

### 3. 個人化推薦系統
- **學習風格識別**: 視覺型、聽覺型、動覺型學習者識別
- **難度自適應**: 根據表現自動調整內容難度
- **內容推薦**: 基於學習歷史推薦相關內容
- **時間優化**: 推薦最佳學習時間和頻率

## 🎨 UI/UX 設計原則

### 1. 認知負荷最小化
- **單一焦點**: 每個畫面只有一個主要任務
- **漸進揭示**: 複雜功能分步驟呈現
- **視覺層次**: 清晰的信息架構和視覺引導
- **一致性**: 統一的交互模式和視覺語言

### 2. 遊戲化元素
- **進度可視化**: 清晰的學習進度指示
- **成就系統**: 基於記憶科學的成就獎勵
- **社交互動**: 學習者之間的良性競爭
- **即時反饋**: 學習行為的即時正面反饋

## 🔧 開發工作流程

### 1. 功能開發順序
1. **記憶科學核心算法** - 間隔重複、主動回憶實現
2. **統一內容管理系統** - 跨遊戲內容模型
3. **25 種遊戲模板** - 基於統一架構的遊戲實現
4. **AI 對話系統** - 智能學習助手
5. **無障礙優化** - 全面的無障礙功能
6. **社區分享系統** - 三層分享模式實現

### 2. 測試要求
- **記憶效果測試**: 每個功能必須驗證記憶科學效果
- **無障礙測試**: 強制性無障礙合規測試
- **跨遊戲兼容性測試**: 內容在不同遊戲間的兼容性
- **性能測試**: 大量用戶和內容的性能表現

### 3. 代碼品質標準
- **TypeScript 強制**: 所有代碼必須使用 TypeScript
- **測試覆蓋率**: 最低 80% 測試覆蓋率
- **文檔完整性**: 每個組件和 API 必須有完整文檔
- **性能監控**: 關鍵路徑的性能監控和優化

## 🚀 部署和維護

### 1. 持續集成/部署
- **自動化測試**: 每次提交自動運行全套測試
- **漸進式部署**: 新功能的 A/B 測試和漸進發布
- **回滾機制**: 快速回滾到穩定版本的能力
- **監控告警**: 系統健康狀況的實時監控

### 2. 數據保護和隱私
- **GDPR 合規**: 歐盟數據保護法規合規
- **數據加密**: 敏感數據的端到端加密
- **訪問控制**: 基於角色的細粒度訪問控制
- **審計日誌**: 完整的用戶行為和系統操作日誌

## 📚 MCP 工具整合規則

### 1. 開發工具鏈整合
- **Playwright MCP**: 用於 Wordwall 競品分析和 E2E 測試
- **Sequential Thinking MCP**: 複雜邏輯推理和算法設計
- **Memory MCP**: 學習數據的持久化和檢索
- **Autogen MCP**: 多智能體協作開發

### 2. AI 輔助開發流程
- **代碼生成**: 使用 MCP 工具自動生成重複性代碼
- **測試自動化**: 自動生成測試用例和測試數據
- **文檔生成**: 自動維護 API 文檔和用戶指南
- **性能優化**: 自動識別和優化性能瓶頸

## 🎯 Wordwall 競品分析整合

### 1. 核心功能對標
- **內容輸入系統**: 參考 Wordwall 的文字/圖片輸入流程
- **遊戲模板系統**: 對標 Wordwall 的 18+ 遊戲模板
- **分享機制**: 實現類似的公開/私人分享功能
- **用戶檔案空間**: 參考 My Activities 的組織結構

### 2. 差異化優勢
- **記憶科學加持**: Wordwall 缺乏的科學記憶算法
- **GEPT 分級整合**: 針對台灣英語學習的本地化
- **AI 智能對話**: 超越 Wordwall 的 AI 輔助學習
- **無障礙設計**: 更完善的無障礙功能支持

## 🔄 開發迭代規則

### 1. MVP 優先級
1. **基礎內容管理** - 用戶可以輸入和保存內容
2. **核心記憶遊戲** - 實現 5 個最重要的記憶遊戲
3. **基本分享功能** - 簡單的內容分享機制
4. **GEPT 分級支持** - 基本的難度分級功能

### 2. 功能擴展順序
1. **Phase 1**: 核心功能 (4週)
2. **Phase 2**: AI 和高級功能 (6週)
3. **Phase 3**: 社區和商業化功能 (4週)
4. **Phase 4**: 優化和擴展 (持續)

### 3. 品質門檻
- **功能完整性**: 每個功能必須完全可用才能發布
- **用戶體驗**: 通過用戶測試驗證易用性
- **性能標準**: 頁面載入時間 < 2秒，互動響應 < 100ms
- **錯誤處理**: 優雅的錯誤處理和用戶提示

## 🛡️ 安全和合規要求

### 1. 數據安全
- **輸入驗證**: 所有用戶輸入必須經過嚴格驗證
- **SQL 注入防護**: 使用參數化查詢和 ORM
- **XSS 防護**: 內容輸出的 HTML 轉義和 CSP 策略
- **文件上傳安全**: 文件類型檢查和病毒掃描

### 2. 隱私保護
- **最小數據收集**: 只收集必要的用戶數據
- **數據匿名化**: 分析數據的去識別化處理
- **用戶控制**: 用戶可以查看、修改、刪除自己的數據
- **透明度**: 清晰的隱私政策和數據使用說明

## 📊 監控和分析

### 1. 學習效果監控
- **記憶保持率**: 追蹤長期記憶效果
- **學習時間分析**: 優化學習時間分配
- **錯誤模式識別**: 識別常見學習困難點
- **個人化效果**: 測量個人化推薦的效果

### 2. 系統性能監控
- **響應時間**: API 和頁面響應時間監控
- **錯誤率**: 系統錯誤和用戶錯誤統計
- **資源使用**: 服務器資源使用情況
- **用戶行為**: 用戶使用模式和流失分析

---

**核心開發哲學**:
1. **學習者優先** - 所有決策以學習效果為最高優先級
2. **科學驅動** - 基於記憶科學研究的功能設計
3. **包容性設計** - 確保所有學習者都能平等使用
4. **持續改進** - 基於數據和反饋的持續優化

**開發提醒**: 每個 PR 都應該包含：
- 記憶科學原理說明
- 無障礙測試結果
- 性能影響評估
- 用戶體驗驗證
