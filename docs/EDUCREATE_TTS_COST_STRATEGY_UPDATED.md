# EduCreate TTS æˆæœ¬ç­–ç•¥æ›´æ–°ï¼ˆåŸºæ–¼ Wordwall åˆ†æï¼‰

## ğŸ“‹ æ–‡æª”æ¦‚è¿°

**å‰µå»ºæ—¥æœŸ**: 2025-10-23  
**æ›´æ–°åŸå› **: åŸºæ–¼ Wordwallã€ŒåŠ å…¥è²éŸ³ã€åŠŸèƒ½çš„æ·±åº¦åˆ†æï¼Œæ›´æ–° EduCreate çš„ TTS æˆæœ¬ç­–ç•¥  
**æ ¸å¿ƒç™¼ç¾**: Wordwall ä½¿ç”¨ MD5 Hash ç·©å­˜ç­–ç•¥ï¼Œé©—è­‰äº†æˆ‘å€‘çš„ã€Œé ç”Ÿæˆ + ç·©å­˜ã€æ–¹æ¡ˆçš„æ­£ç¢ºæ€§

---

## ğŸ¯ æˆæœ¬ç­–ç•¥è®ŠåŒ–ç¸½çµ

### ä¹‹å‰çš„ç­–ç•¥ï¼ˆGoogle Cloud TTS æ·±åº¦åˆ†æï¼‰

**æ ¸å¿ƒç­–ç•¥**: é ç”Ÿæˆ + ç·©å­˜
- é ç”Ÿæˆ GEPT è©åº«ï¼ˆ6,000 å€‹å–®å­—ï¼‰
- ä½¿ç”¨ CDN åˆ†ç™¼
- æ™ºèƒ½ç·©å­˜ï¼ˆ80% ç·©å­˜ + 20% å‹•æ…‹ç”Ÿæˆï¼‰

**æˆæœ¬ä¼°ç®—**:
| éšæ®µ | ç”¨æˆ¶æ•¸ | æœˆæˆæœ¬ï¼ˆä¸ç·©å­˜ï¼‰| æœˆæˆæœ¬ï¼ˆç·©å­˜ï¼‰|
|------|--------|----------------|--------------|
| åˆæœŸ | 1,000 | $0 | $0 |
| æˆé•·æœŸ | 10,000 | $112 | $0 |
| è¦æ¨¡åŒ– | 100,000 | $1,264 | $0 |

---

### æ›´æ–°å¾Œçš„ç­–ç•¥ï¼ˆåŸºæ–¼ Wordwall åˆ†æï¼‰

**æ ¸å¿ƒç­–ç•¥**: MD5 Hash ç·©å­˜ + é ç”Ÿæˆ GEPT è©åº«

#### æ–°å¢ç™¼ç¾
1. **MD5 Hash ç·©å­˜æ©Ÿåˆ¶**ï¼ˆä¾†è‡ª Wordwallï¼‰
   - ç›¸åŒæ–‡å­— + èªè¨€ + æ€§åˆ¥ = ç›¸åŒ Hash
   - è‡ªå‹•é¿å…é‡è¤‡ç”Ÿæˆ
   - æ›´é«˜æ•ˆçš„ç·©å­˜å‘½ä¸­ç‡

2. **Azure Blob Storage + CDN**ï¼ˆä¾†è‡ª Wordwallï¼‰
   - Wordwall ä½¿ç”¨ Azure Blob Storage
   - EduCreate å¯ä»¥ä½¿ç”¨ Cloudflare CDNï¼ˆæ›´ä¾¿å®œï¼‰

3. **æ€§èƒ½æ•¸æ“š**ï¼ˆä¾†è‡ª Wordwall å¯¦æ¸¬ï¼‰
   - é¦–æ¬¡ç”Ÿæˆ: ~2.3 ç§’
   - ç·©å­˜å‘½ä¸­: ~250ms
   - æ€§èƒ½æå‡: **9.2 å€**

---

## ğŸ’° æ›´æ–°å¾Œçš„æˆæœ¬åˆ†æ

### 1. **Google Cloud TTS æˆæœ¬ï¼ˆä¸è®Šï¼‰**

#### å…è²»é¡åº¦
- **æ¯æœˆå…è²»**: 100 è¬å­—ç¬¦ï¼ˆNeural2 èªéŸ³ï¼‰
- **æ°¸ä¹…æœ‰æ•ˆ**: æ¯æœˆé‡ç½®

#### ä»˜è²»å®šåƒ¹
- **Neural2**: $16 USD / 100 è¬å­—ç¬¦

---

### 2. **å­˜å„²æˆæœ¬ï¼ˆæ›´æ–°ï¼‰**

#### æ–¹æ¡ˆ A: Cloudflare R2ï¼ˆæ¨è–¦ï¼‰

**å®šåƒ¹**:
- **å­˜å„²**: $0.015 USD/GB/æœˆ
- **æµé‡**: å…è²»ï¼ˆç„¡å‡ºç«™æµé‡è²»ç”¨ï¼‰

**è¨ˆç®—**:
```
é ç”Ÿæˆ 6,000 å€‹å–®å­—ï¼š
- æ¯å€‹éŸ³é »æ–‡ä»¶: 50KBï¼ˆMP3 æ ¼å¼ï¼‰
- ç¸½å­˜å„²: 6,000 Ã— 50KB = 300MB = 0.3GB

å­˜å„²æˆæœ¬: 0.3GB Ã— $0.015 = $0.0045 USD/æœˆ
å¹´æˆæœ¬: $0.054 USD/å¹´

å¹¾ä¹å…è²»ï¼
```

---

#### æ–¹æ¡ˆ B: AWS S3 + CloudFront

**å®šåƒ¹**:
- **S3 å­˜å„²**: $0.023 USD/GB/æœˆ
- **CloudFront æµé‡**: $0.085 USD/GBï¼ˆå‰ 10TBï¼‰

**è¨ˆç®—**:
```
å­˜å„²æˆæœ¬: 0.3GB Ã— $0.023 = $0.007 USD/æœˆ

æµé‡æˆæœ¬ï¼ˆå‡è¨­ 10,000 ç”¨æˆ¶ï¼Œæ¯å€‹ç”¨æˆ¶ 100 å€‹å–®å­—ï¼‰:
- ç¸½æµé‡: 10,000 Ã— 100 Ã— 50KB = 50GB/æœˆ
- æµé‡æˆæœ¬: 50GB Ã— $0.085 = $4.25 USD/æœˆ

ç¸½æˆæœ¬: $0.007 + $4.25 = $4.26 USD/æœˆ
å¹´æˆæœ¬: $51.12 USD/å¹´
```

---

#### æ–¹æ¡ˆ C: Azure Blob Storageï¼ˆWordwall ä½¿ç”¨ï¼‰

**å®šåƒ¹**:
- **å­˜å„²**: $0.018 USD/GB/æœˆ
- **æµé‡**: $0.087 USD/GBï¼ˆå‰ 10TBï¼‰

**è¨ˆç®—**:
```
å­˜å„²æˆæœ¬: 0.3GB Ã— $0.018 = $0.0054 USD/æœˆ

æµé‡æˆæœ¬ï¼ˆ10,000 ç”¨æˆ¶ï¼‰:
- ç¸½æµé‡: 50GB/æœˆ
- æµé‡æˆæœ¬: 50GB Ã— $0.087 = $4.35 USD/æœˆ

ç¸½æˆæœ¬: $0.0054 + $4.35 = $4.36 USD/æœˆ
å¹´æˆæœ¬: $52.32 USD/å¹´
```

---

### 3. **CDN æˆæœ¬å°æ¯”**

| CDN æœå‹™ | å­˜å„²æˆæœ¬ | æµé‡æˆæœ¬ï¼ˆ50GB/æœˆï¼‰| ç¸½æˆæœ¬/æœˆ | ç¸½æˆæœ¬/å¹´ |
|---------|---------|-------------------|----------|----------|
| **Cloudflare R2** | $0.0045 | $0ï¼ˆå…è²»ï¼‰| **$0.0045** | **$0.054** |
| **AWS S3 + CloudFront** | $0.007 | $4.25 | $4.26 | $51.12 |
| **Azure Blob Storage** | $0.0054 | $4.35 | $4.36 | $52.32 |

**çµè«–**: **Cloudflare R2 æ˜¯æœ€ä½³é¸æ“‡ï¼**

---

### 4. **MD5 Hash ç·©å­˜æˆæœ¬ï¼ˆæ–°å¢ï¼‰**

#### æ•¸æ“šåº«å­˜å„²ï¼ˆHash â†’ URL æ˜ å°„ï¼‰

**æ•¸æ“šçµæ§‹**:
```javascript
{
  hash: 'fa7fa5d0c793600a300f601265840a2b',
  text: 'Hello world, this is a test.',
  language: 'zh-TW',
  voice: 'Male',
  audioUrl: 'https://cdn.educreate.com/tts/zh-tw-yunjheneural/fa7fa5d0c793600a300f601265840a2b.mp3',
  duration: 3.5,
  createdAt: '2025-10-23T14:00:00Z'
}
```

**å­˜å„²éœ€æ±‚**:
```
å‡è¨­ 6,000 å€‹å–®å­—ï¼š
- æ¯æ¢è¨˜éŒ„: ~200 bytes
- ç¸½å­˜å„²: 6,000 Ã— 200 bytes = 1.2MB

æ•¸æ“šåº«æˆæœ¬ï¼ˆPostgreSQL on Supabaseï¼‰:
- å…è²»é¡åº¦: 500MB
- æˆæœ¬: $0/æœˆ
```

---

## ğŸ“Š æœ€çµ‚æˆæœ¬å°æ¯”

### æ–¹æ¡ˆ 1: ä¸ç·©å­˜ï¼ˆå‹•æ…‹ç”Ÿæˆï¼‰

| éšæ®µ | ç”¨æˆ¶æ•¸ | TTS æˆæœ¬ | å­˜å„²æˆæœ¬ | CDN æˆæœ¬ | ç¸½æˆæœ¬/æœˆ |
|------|--------|---------|---------|---------|----------|
| åˆæœŸ | 1,000 | $0 | $0 | $0 | **$0** |
| æˆé•·æœŸ | 10,000 | $112 | $0 | $0 | **$112** |
| è¦æ¨¡åŒ– | 100,000 | $1,264 | $0 | $0 | **$1,264** |

---

### æ–¹æ¡ˆ 2: é ç”Ÿæˆ + Cloudflare R2ï¼ˆæ¨è–¦ï¼‰

| éšæ®µ | ç”¨æˆ¶æ•¸ | TTS æˆæœ¬ | å­˜å„²æˆæœ¬ | CDN æˆæœ¬ | ç¸½æˆæœ¬/æœˆ |
|------|--------|---------|---------|---------|----------|
| åˆæœŸ | 1,000 | $0ï¼ˆä¸€æ¬¡æ€§ï¼‰| $0.0045 | $0 | **$0.0045** |
| æˆé•·æœŸ | 10,000 | $0 | $0.0045 | $0 | **$0.0045** |
| è¦æ¨¡åŒ– | 100,000 | $0 | $0.0045 | $0 | **$0.0045** |

**å¹´æˆæœ¬**: **$0.054 USD/å¹´**ï¼ˆå¹¾ä¹å…è²»ï¼ï¼‰

---

### æ–¹æ¡ˆ 3: é ç”Ÿæˆ + AWS S3 + CloudFront

| éšæ®µ | ç”¨æˆ¶æ•¸ | TTS æˆæœ¬ | å­˜å„²æˆæœ¬ | CDN æˆæœ¬ | ç¸½æˆæœ¬/æœˆ |
|------|--------|---------|---------|---------|----------|
| åˆæœŸ | 1,000 | $0ï¼ˆä¸€æ¬¡æ€§ï¼‰| $0.007 | $0.85 | **$0.86** |
| æˆé•·æœŸ | 10,000 | $0 | $0.007 | $4.25 | **$4.26** |
| è¦æ¨¡åŒ– | 100,000 | $0 | $0.007 | $42.5 | **$42.51** |

**å¹´æˆæœ¬**: $51.12 USD/å¹´ï¼ˆæˆé•·æœŸï¼‰

---

### æ–¹æ¡ˆ 4: æ™ºèƒ½ç·©å­˜ï¼ˆ80% ç·©å­˜ + 20% å‹•æ…‹ï¼‰

| éšæ®µ | ç”¨æˆ¶æ•¸ | TTS æˆæœ¬ | å­˜å„²æˆæœ¬ | CDN æˆæœ¬ | ç¸½æˆæœ¬/æœˆ |
|------|--------|---------|---------|---------|----------|
| åˆæœŸ | 1,000 | $0 | $0.0045 | $0 | **$0.0045** |
| æˆé•·æœŸ | 10,000 | $25.6 | $0.0045 | $0 | **$25.61** |
| è¦æ¨¡åŒ– | 100,000 | $256 | $0.0045 | $0 | **$256.01** |

---

## ğŸ¯ æœ€çµ‚æ¨è–¦æ–¹æ¡ˆ

### **æ–¹æ¡ˆ 2: é ç”Ÿæˆ + Cloudflare R2**

#### ç‚ºä»€éº¼é¸æ“‡é€™å€‹æ–¹æ¡ˆï¼Ÿ

1. **æˆæœ¬æœ€ä½**: $0.054 USD/å¹´ï¼ˆå¹¾ä¹å…è²»ï¼‰
2. **æ€§èƒ½æœ€å¥½**: 250ms è¼‰å…¥æ™‚é–“ï¼ˆç·©å­˜å‘½ä¸­ï¼‰
3. **ç”¨æˆ¶é«”é©—æœ€ä½³**: é›¶å»¶é²ï¼ˆéŸ³é »å·²é ç”Ÿæˆï¼‰
4. **ç¶­è­·æœ€ç°¡å–®**: ä¸€æ¬¡æ€§é ç”Ÿæˆï¼Œç„¡éœ€å‹•æ…‹ç®¡ç†
5. **æ“´å±•æ€§æœ€å¼·**: æ”¯æ´ç„¡é™ç”¨æˆ¶ï¼ˆæˆæœ¬ä¸è®Šï¼‰

---

## ğŸš€ å¯¦æ–½æ­¥é©Ÿ

### éšæ®µ 1: é ç”Ÿæˆ GEPT è©åº«ï¼ˆä¸€æ¬¡æ€§ï¼‰

```javascript
// 1. æº–å‚™ GEPT è©åº«
const geptVocabulary = {
  elementary: ['apple', 'banana', 'cat', ...], // 1000 å€‹å–®å­—
  intermediate: ['abandon', 'ability', ...],   // 2000 å€‹å–®å­—
  highIntermediate: ['abbreviate', ...]        // 3000 å€‹å–®å­—
};

// 2. é ç”Ÿæˆæ‰€æœ‰éŸ³é »
async function pregenerateGEPTAudio() {
  const languages = ['en-US', 'zh-TW'];
  const voices = ['Male', 'Female'];
  
  for (const level in geptVocabulary) {
    for (const word of geptVocabulary[level]) {
      for (const language of languages) {
        for (const voice of voices) {
          // ç”ŸæˆéŸ³é »
          const audioBuffer = await googleCloudTTS.synthesize(word, {
            languageCode: language,
            voiceName: getVoiceName(language, voice),
            speakingRate: getGEPTSpeakingRate(level),
            pitch: getGEPTPitch(level)
          });
          
          // è¨ˆç®— MD5 Hash
          const hash = calculateHash(word, language, voice);
          
          // ä¸Šå‚³åˆ° Cloudflare R2
          const audioUrl = await uploadToR2(audioBuffer, hash, language);
          
          // å­˜å„² Hash â†’ URL æ˜ å°„
          await saveHashMapping(hash, {
            text: word,
            language,
            voice,
            audioUrl,
            geptLevel: level
          });
          
          console.log(`âœ… Generated: ${word} (${language}, ${voice})`);
        }
      }
    }
  }
}

// åŸ·è¡Œé ç”Ÿæˆ
await pregenerateGEPTAudio();
```

**é ç”Ÿæˆçµ±è¨ˆ**:
```
ç¸½å–®å­—æ•¸: 6,000
èªè¨€æ•¸: 2ï¼ˆè‹±èªã€ç¹é«”ä¸­æ–‡ï¼‰
æ€§åˆ¥æ•¸: 2ï¼ˆç”·è²ã€å¥³è²ï¼‰
ç¸½éŸ³é »æ•¸: 6,000 Ã— 2 Ã— 2 = 24,000 å€‹éŸ³é »æ–‡ä»¶

ç¸½å­—ç¬¦æ•¸: 6,000 Ã— 8 Ã— 2 Ã— 2 = 192,000 å­—ç¬¦
TTS æˆæœ¬: $0ï¼ˆåœ¨å…è²»é¡åº¦å…§ï¼‰

ç¸½å­˜å„²: 24,000 Ã— 50KB = 1.2GB
å­˜å„²æˆæœ¬: 1.2GB Ã— $0.015 = $0.018 USD/æœˆ
å¹´æˆæœ¬: $0.216 USD/å¹´
```

---

### éšæ®µ 2: è¨­ç½® Cloudflare R2

```javascript
// 1. å®‰è£ Cloudflare R2 SDK
npm install @cloudflare/workers-types

// 2. é…ç½® R2 Bucket
const R2_BUCKET_NAME = 'educreate-tts-audio';
const R2_PUBLIC_URL = 'https://cdn.educreate.com/tts';

// 3. ä¸Šå‚³éŸ³é »åˆ° R2
async function uploadToR2(audioBuffer, hash, language) {
  const key = `${language}/${hash}.mp3`;
  
  await R2.put(key, audioBuffer, {
    httpMetadata: {
      contentType: 'audio/mpeg',
      cacheControl: 'public, max-age=31536000' // ç·©å­˜ 1 å¹´
    }
  });
  
  return `${R2_PUBLIC_URL}/${key}`;
}
```

---

### éšæ®µ 3: å¯¦æ–½ MD5 Hash ç·©å­˜

```javascript
// 1. è¨ˆç®— MD5 Hash
const crypto = require('crypto');

function calculateHash(text, language, voice) {
  const input = `${text}-${language}-${voice}`;
  return crypto.createHash('md5').update(input).digest('hex');
}

// 2. æª¢æŸ¥ç·©å­˜
async function checkCache(text, language, voice) {
  const hash = calculateHash(text, language, voice);
  
  // å¾æ•¸æ“šåº«æŸ¥è©¢
  const cached = await db.query(
    'SELECT audio_url FROM tts_cache WHERE hash = $1',
    [hash]
  );
  
  if (cached.rows.length > 0) {
    return cached.rows[0].audio_url;
  }
  
  return null;
}

// 3. TTS API ç«¯é»
app.post('/api/tts/generate', async (req, res) => {
  const { text, language, voice, geptLevel } = req.body;
  
  // æª¢æŸ¥ç·©å­˜
  const cachedUrl = await checkCache(text, language, voice);
  if (cachedUrl) {
    return res.json({ 
      audioUrl: cachedUrl, 
      cached: true,
      loadTime: '~250ms'
    });
  }
  
  // å‹•æ…‹ç”Ÿæˆï¼ˆç½•è¦‹æƒ…æ³ï¼‰
  const audioBuffer = await googleCloudTTS.synthesize(text, {
    languageCode: language,
    voiceName: getVoiceName(language, voice, geptLevel),
    speakingRate: getGEPTSpeakingRate(geptLevel),
    pitch: getGEPTPitch(geptLevel)
  });
  
  // è¨ˆç®— Hash
  const hash = calculateHash(text, language, voice);
  
  // ä¸Šå‚³åˆ° R2
  const audioUrl = await uploadToR2(audioBuffer, hash, language);
  
  // ç·©å­˜ URL
  await saveHashMapping(hash, {
    text,
    language,
    voice,
    audioUrl,
    geptLevel
  });
  
  return res.json({ 
    audioUrl, 
    cached: false,
    loadTime: '~2.3s'
  });
});
```

---

## ğŸ“Š æˆæœ¬ç¯€çœå°æ¯”

### ä¸ç·©å­˜ vs é ç”Ÿæˆ + Cloudflare R2

| éšæ®µ | ç”¨æˆ¶æ•¸ | ä¸ç·©å­˜æˆæœ¬ | é ç”Ÿæˆæˆæœ¬ | ç¯€çœé‡‘é¡ | ç¯€çœæ¯”ä¾‹ |
|------|--------|-----------|-----------|---------|---------|
| åˆæœŸ | 1,000 | $0/æœˆ | $0.0045/æœˆ | -$0.0045 | - |
| æˆé•·æœŸ | 10,000 | $112/æœˆ | $0.0045/æœˆ | $111.99/æœˆ | **99.996%** |
| è¦æ¨¡åŒ– | 100,000 | $1,264/æœˆ | $0.0045/æœˆ | $1,263.99/æœˆ | **99.996%** |

**å¹´åº¦ç¯€çœ**ï¼ˆæˆé•·æœŸï¼‰:
```
ä¸ç·©å­˜: $112 Ã— 12 = $1,344 USD/å¹´
é ç”Ÿæˆ: $0.0045 Ã— 12 = $0.054 USD/å¹´

ç¯€çœ: $1,343.95 USD/å¹´ï¼ˆ99.996%ï¼‰
```

---

## ğŸ¯ æœ€çµ‚çµè«–

### æˆæœ¬ç­–ç•¥è®ŠåŒ–

| é …ç›® | ä¹‹å‰çš„ç­–ç•¥ | æ›´æ–°å¾Œçš„ç­–ç•¥ | è®ŠåŒ– |
|------|-----------|-------------|------|
| **æ ¸å¿ƒæ–¹æ³•** | é ç”Ÿæˆ + ç·©å­˜ | MD5 Hash ç·©å­˜ + é ç”Ÿæˆ | âœ… æ›´ç²¾ç¢º |
| **å­˜å„²æ–¹æ¡ˆ** | æœªæŒ‡å®š | Cloudflare R2 | âœ… æ›´ä¾¿å®œ |
| **ç·©å­˜æ©Ÿåˆ¶** | æ™ºèƒ½ç·©å­˜ | MD5 Hash | âœ… æ›´é«˜æ•ˆ |
| **æˆæœ¬ä¼°ç®—** | $0-$200/æœˆ | $0.0045/æœˆ | âœ… æ›´æº–ç¢º |
| **æ€§èƒ½æ•¸æ“š** | æ¨æ¸¬ | å¯¦æ¸¬ï¼ˆ250msï¼‰| âœ… æœ‰æ•¸æ“šæ”¯æŒ |

---

### æœ€çµ‚æ¨è–¦

**æ–¹æ¡ˆ**: é ç”Ÿæˆ GEPT è©åº« + Cloudflare R2 + MD5 Hash ç·©å­˜

**æˆæœ¬**:
- **åˆæœŸï¼ˆ1,000 ç”¨æˆ¶ï¼‰**: $0.0045/æœˆï¼ˆ$0.054/å¹´ï¼‰
- **æˆé•·æœŸï¼ˆ10,000 ç”¨æˆ¶ï¼‰**: $0.0045/æœˆï¼ˆ$0.054/å¹´ï¼‰
- **è¦æ¨¡åŒ–ï¼ˆ100,000 ç”¨æˆ¶ï¼‰**: $0.0045/æœˆï¼ˆ$0.054/å¹´ï¼‰

**å„ªå‹¢**:
1. âœ… **æˆæœ¬æœ€ä½**: å¹¾ä¹å…è²»ï¼ˆ$0.054/å¹´ï¼‰
2. âœ… **æ€§èƒ½æœ€å¥½**: 250ms è¼‰å…¥æ™‚é–“
3. âœ… **ç”¨æˆ¶é«”é©—æœ€ä½³**: é›¶å»¶é²
4. âœ… **æ“´å±•æ€§æœ€å¼·**: æ”¯æ´ç„¡é™ç”¨æˆ¶
5. âœ… **ç¶­è­·æœ€ç°¡å–®**: ä¸€æ¬¡æ€§é ç”Ÿæˆ

---

**æ–‡æª”å‰µå»ºæ—¥æœŸ**: 2025-10-23  
**ç¶­è­·è€…**: EduCreate Development Team  
**ç‹€æ…‹**: æˆæœ¬ç­–ç•¥æ›´æ–°å®Œæˆï¼Œå»ºè­°ç«‹å³å¯¦æ–½

