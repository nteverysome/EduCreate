# ContentItemWithImage 進階功能規劃

**規劃日期**: 2025-10-22  
**功能版本**: v2.0  
**優先級**: 優先級 2

---

## 📋 功能需求

根據用戶需求，需要為 ContentItemWithImage 組件添加以下功能：

1. **多個文字區塊** - 支援在同一張圖片上添加多個獨立的文字區塊
2. **文字旋轉** - 每個文字區塊可以旋轉角度
3. **更多顏色選項** - 擴展顏色選擇（不只白色和黑色）
4. **字體選擇** - 提供多種字體選項
5. **文字陰影效果** - 添加文字陰影以提升可讀性

---

## 🎯 設計方案

### 方案 A：完整實施（推薦）

**實施所有 5 個功能**

**優點**:
- ✅ 完整滿足用戶需求
- ✅ 功能豐富，用戶體驗最佳
- ✅ 與 Wordwall 功能對等

**缺點**:
- ⚠️ 開發時間較長（約 3-4 小時）
- ⚠️ UI 複雜度增加
- ⚠️ 測試工作量大

**實施順序**:
1. 多個文字區塊（核心功能）
2. 更多顏色選項（視覺增強）
3. 字體選擇（視覺增強）
4. 文字旋轉（進階功能）
5. 文字陰影效果（視覺增強）

---

### 方案 B：分階段實施

**第一階段（核心功能）**:
1. 多個文字區塊
2. 更多顏色選項

**第二階段（視覺增強）**:
3. 字體選擇
4. 文字陰影效果

**第三階段（進階功能）**:
5. 文字旋轉

**優點**:
- ✅ 快速交付核心功能
- ✅ 降低單次開發風險
- ✅ 可根據反饋調整

**缺點**:
- ⚠️ 需要多次部署
- ⚠️ 用戶需要等待完整功能

---

### 方案 C：簡化實施

**只實施最重要的 3 個功能**:
1. 多個文字區塊
2. 更多顏色選項
3. 字體選擇

**優點**:
- ✅ 快速完成（約 2 小時）
- ✅ 滿足主要需求
- ✅ UI 複雜度適中

**缺點**:
- ⚠️ 缺少文字旋轉和陰影
- ⚠️ 功能不夠完整

---

## 🔧 技術實現方案

### 1. 多個文字區塊

#### 數據結構

```typescript
interface TextBlock {
  id: string;
  text: string;
  position: { x: number; y: number }; // percentage
  fontSize: 'small' | 'medium' | 'large';
  textColor: string; // hex color
  fontFamily: string;
  rotation: number; // degrees
  showBackground: boolean;
  shadow: boolean;
}

interface ContentItem {
  id: string;
  imageId?: string;
  imageUrl?: string;
  text: string; // 保留用於向後兼容
  position: number;
  textBlocks?: TextBlock[]; // 新增
}
```

#### UI 設計

```
┌─────────────────────────────────────┐
│ 內容項目 #1                    [刪除]│
├─────────────────────────────────────┤
│                                     │
│  [圖片預覽 + 多個文字區塊]           │
│                                     │
├─────────────────────────────────────┤
│ 文字區塊列表:                        │
│ ┌─────────────────────────────────┐ │
│ │ 文字區塊 1  [選中] [刪除]        │ │
│ │ 文字: "標題文字"                 │ │
│ │ 位置: (50%, 20%)                │ │
│ └─────────────────────────────────┘ │
│ ┌─────────────────────────────────┐ │
│ │ 文字區塊 2  [選中] [刪除]        │ │
│ │ 文字: "副標題"                   │ │
│ │ 位置: (50%, 80%)                │ │
│ └─────────────────────────────────┘ │
│ [+ 添加文字區塊]                     │
├─────────────────────────────────────┤
│ 文字樣式 (當前選中的區塊):           │
│ 大小: [小] [中] [大]                │
│ 顏色: [🎨 顏色選擇器]               │
│ 字體: [下拉選單]                    │
│ 旋轉: [滑桿 0-360°]                 │
│ 陰影: [開] [關]                     │
│ 背景: [開] [關]                     │
└─────────────────────────────────────┘
```

#### 實施步驟

1. **更新數據結構**
   - 添加 `TextBlock` 接口
   - 更新 `ContentItem` 接口
   - 添加 `textBlocks` 數組

2. **添加文字區塊管理**
   - 添加文字區塊按鈕
   - 刪除文字區塊按鈕
   - 選擇當前編輯的文字區塊

3. **更新 UI 渲染**
   - 渲染多個文字區塊
   - 高亮當前選中的區塊
   - 支援拖動每個區塊

4. **更新圖片生成邏輯**
   - 修改 `overlayTextOnImage` 函數
   - 支援渲染多個文字區塊
   - 應用所有樣式（顏色、字體、旋轉、陰影）

---

### 2. 更多顏色選項

#### 顏色預設

```typescript
const TEXT_COLORS = [
  { name: '白色', value: '#FFFFFF' },
  { name: '黑色', value: '#000000' },
  { name: '紅色', value: '#EF4444' },
  { name: '藍色', value: '#3B82F6' },
  { name: '綠色', value: '#10B981' },
  { name: '黃色', value: '#F59E0B' },
  { name: '紫色', value: '#8B5CF6' },
  { name: '粉色', value: '#EC4899' },
  { name: '自定義', value: 'custom' },
];
```

#### UI 設計

```
顏色: [⚪] [⚫] [🔴] [🔵] [🟢] [🟡] [🟣] [🌸] [🎨]
      白色  黑色  紅色  藍色  綠色  黃色  紫色  粉色  自定義

[自定義顏色選擇器]
```

---

### 3. 字體選擇

#### 字體預設

```typescript
const FONT_FAMILIES = [
  { name: '預設', value: 'Arial, sans-serif' },
  { name: '黑體', value: '"Microsoft JhengHei", "微軟正黑體", sans-serif' },
  { name: '明體', value: '"PMingLiU", "新細明體", serif' },
  { name: '楷體', value: '"DFKai-SB", "標楷體", serif' },
  { name: '圓體', value: '"Microsoft YaHei", "微軟雅黑", sans-serif' },
];
```

#### UI 設計

```
字體: [下拉選單 ▼]
      ├─ 預設
      ├─ 黑體
      ├─ 明體
      ├─ 楷體
      └─ 圓體
```

---

### 4. 文字旋轉

#### UI 設計

```
旋轉: [━━━━●━━━━] 45°
      0°         360°

或

旋轉: [-90°] [0°] [+90°] [180°]
```

#### 實施

- 使用 CSS `transform: rotate()`
- 在圖片生成時使用 Canvas `rotate()`

---

### 5. 文字陰影效果

#### 陰影選項

```typescript
interface TextShadow {
  enabled: boolean;
  offsetX: number;
  offsetY: number;
  blur: number;
  color: string;
}
```

#### UI 設計

```
陰影: [開] [關]

當開啟時:
- 偏移 X: [━━●━━] 2px
- 偏移 Y: [━━●━━] 2px
- 模糊: [━━●━━] 4px
- 顏色: [⚫ 黑色]
```

---

## 📊 工作量估算

### 方案 A：完整實施

| 功能 | 開發時間 | 測試時間 | 總計 |
|------|---------|---------|------|
| 多個文字區塊 | 1.5 小時 | 0.5 小時 | 2 小時 |
| 更多顏色選項 | 0.5 小時 | 0.25 小時 | 0.75 小時 |
| 字體選擇 | 0.5 小時 | 0.25 小時 | 0.75 小時 |
| 文字旋轉 | 0.75 小時 | 0.25 小時 | 1 小時 |
| 文字陰影效果 | 0.75 小時 | 0.25 小時 | 1 小時 |
| **總計** | **4 小時** | **1.5 小時** | **5.5 小時** |

### 方案 B：分階段實施

**第一階段**:
- 多個文字區塊 + 更多顏色選項
- 時間：約 3 小時

**第二階段**:
- 字體選擇 + 文字陰影效果
- 時間：約 2 小時

**第三階段**:
- 文字旋轉
- 時間：約 1 小時

**總計**: 6 小時（分 3 次完成）

### 方案 C：簡化實施

| 功能 | 開發時間 | 測試時間 | 總計 |
|------|---------|---------|------|
| 多個文字區塊 | 1.5 小時 | 0.5 小時 | 2 小時 |
| 更多顏色選項 | 0.5 小時 | 0.25 小時 | 0.75 小時 |
| 字體選擇 | 0.5 小時 | 0.25 小時 | 0.75 小時 |
| **總計** | **2.5 小時** | **1 小時** | **3.5 小時** |

---

## 🎨 UI/UX 考量

### 複雜度管理

**問題**: 添加多個文字區塊後，UI 會變得複雜

**解決方案**:
1. **折疊面板**: 文字區塊列表可折疊
2. **標籤頁**: 將樣式控制分組到標籤頁
3. **浮動面板**: 樣式控制使用浮動面板
4. **簡化模式**: 提供簡化模式和進階模式切換

### 移動端適配

**挑戰**: 小螢幕上顯示多個控制項

**解決方案**:
1. **響應式佈局**: 使用 Grid/Flexbox 自動調整
2. **滾動區域**: 控制面板可滾動
3. **觸控優化**: 按鈕大小適合觸控操作

---

## 🔮 未來擴展

### 優先級 3: 更多進階功能

1. **文字描邊** - 添加文字外框
2. **漸變顏色** - 支援漸變文字顏色
3. **文字動畫** - 添加簡單的動畫效果（僅預覽）
4. **圖層管理** - 調整文字區塊的層級順序
5. **模板系統** - 保存和重用文字樣式模板

### 優先級 4: 協作功能

1. **樣式複製** - 複製一個文字區塊的樣式到另一個
2. **批量編輯** - 同時編輯多個文字區塊
3. **對齊輔助** - 自動對齊和分布文字區塊
4. **網格系統** - 添加網格輔助定位

---

## 📝 建議

### 推薦方案

**推薦：方案 B（分階段實施）**

**理由**:
1. **快速交付核心功能** - 第一階段 3 小時即可交付多個文字區塊和顏色選項
2. **降低風險** - 分階段實施可以及時發現問題並調整
3. **用戶反饋** - 可以根據第一階段的用戶反饋優化後續功能
4. **時間靈活** - 可以根據優先級調整後續階段的實施時間

### 第一階段實施計畫

**目標**: 實施多個文字區塊 + 更多顏色選項

**時間**: 約 3 小時

**交付內容**:
1. ✅ 支援添加/刪除多個文字區塊
2. ✅ 每個文字區塊可獨立拖動
3. ✅ 8 種預設顏色 + 自定義顏色選擇器
4. ✅ 文字區塊列表管理
5. ✅ 圖片生成支援多個文字區塊

**測試項目**:
1. 添加 3 個文字區塊
2. 拖動每個區塊到不同位置
3. 設置不同顏色
4. 生成圖片並驗證
5. 版本記錄功能驗證

---

**文檔版本**: v1.0  
**最後更新**: 2025-10-22  
**作者**: AI Agent  
**狀態**: 待用戶確認

